(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.HeliaRouters = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var HeliaRouters=(()=>{var pf=Object.create;var en=Object.defineProperty;var mf=Object.getOwnPropertyDescriptor;var gf=Object.getOwnPropertyNames;var yf=Object.getPrototypeOf,xf=Object.prototype.hasOwnProperty;var _s=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),At=(e,t)=>{for(var r in t)en(e,r,{get:t[r],enumerable:!0})},Ls=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of gf(t))!xf.call(e,o)&&o!==r&&en(e,o,{get:()=>t[o],enumerable:!(n=mf(t,o))||n.enumerable});return e};var wo=(e,t,r)=>(r=e!=null?pf(yf(e)):{},Ls(t||!e||!e.__esModule?en(r,"default",{value:e,enumerable:!0}):r,e)),wf=e=>Ls(en({},"__esModule",{value:!0}),e);var ns=_s((pb,rs)=>{var hb=function(){typeof rs<"u"&&(rs.exports=y);var e=86400,t=3200,r=146097*t/400,n=e*r,o=1e3*n,i=864e13,s=4294967296,a=1e6,c="000000000",l=Math.trunc||function(w){var E=w-w%1;return E==0&&(w<0||w===0&&1/w!=1/0)?-0:E},u=y.prototype,f=(y.fromDate=function(w){return new y(+w)},y.fromInt64BE=P(0,1,2,3,0,4),y.fromInt64LE=P(3,2,1,0,4,0),y.fromString=function(_){var E,F=new y,_=(_+="").replace(/^\s*[+\-]?\d+/,function(K){var K=+K,A=1970+(K-1970)%400;return F.year=K-A,A}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(U,K,A){return K<0&&(A*=-1),E=6e4*(60*+K+ +A),""}).replace(/\.\d+$/,function(U){return F.nano=+(U+c).substr(1,9),""}).split(/\D+/);if(1<_.length?_[1]--:_[1]=0,F.time=E=Date.UTC.apply(Date,_)-(E||0),isNaN(E))throw new TypeError("Invalid Date");return h(F)},y.fromTimeT=function(w){return C(w,0)},u.year=0,u.time=0,u.nano=0,u.addNano=function(w){return this.nano+=+w||0,this},u.getNano=function(){var w=h(this);return(w.time%1e3*a+ +w.nano+1e9)%1e9},u.getTimeT=function(){var E=h(this),w=Math.floor(E.time/1e3),E=E.year;return E&&(w+=E*r*e/t),w},u.getYear=function(){return this.toDate().getUTCFullYear()+this.year},u.toDate=function(){return v(h(this).time)},u.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},u.toString=function(w){var E=this,F=E.toDate(),_={H:function(){return k(F.getUTCHours())},L:function(){return R(F.getUTCMilliseconds(),3)},M:function(){return k(F.getUTCMinutes())},N:function(){return R(E.getNano(),9)},S:function(){return k(F.getUTCSeconds())},Y:function(){var U=E.getYear();return 999999<U?"+"+U:9999<U?"+"+R(U,6):0<=U?R(U,4):-999999<=U?"-"+R(-U,6):U},a:function(){return b[F.getUTCDay()]},b:function(){return d[F.getUTCMonth()]},d:function(){return k(F.getUTCDate())},e:function(){return function(U){return(9<U?"":" ")+(0|U)}(F.getUTCDate())},m:function(){return k(F.getUTCMonth()+1)}};return function U(K){return K.replace(/%./g,function(A){var m=A[1],I=T[m],m=_[m];return I?U(I):m?m():A})}(w||f)},u.writeInt64BE=x(0,1,2,3,0,4),u.writeInt64LE=x(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],T={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return y;function y(w,E,F){var _=this;if(!(_ instanceof y))return new y(w,E,F);_.time=+w||0,_.nano=+E||0,_.year=+F||0,h(_)}function h(w){var E,F,_,U=w.year,K=w.time,A=w.nano,I=((A<0||a<=A)&&(A-=(F=Math.floor(A/a))*a,K+=F,F=1),U%t);return(K<-i||i<K||I)&&((E=l(K/o))&&(U+=E*t,K-=E*o),(_=v(K)).setUTCFullYear(I+_.getUTCFullYear()),_=(K=+_)+(E=l((U-=I)/t))*o,E&&-i<=_&&_<=i&&(U-=E*t,K=_),F=1),F&&(w.year=U,w.time=K,w.nano=A),w}function v(w){var E=new Date(0);return E.setTime(w),E}function C(U,_){U=+U||0;var F=l((_=(_|0)*s)/n)+l(U/n),_=_%n+U%n,U=l(_/n);return U&&(F+=U,_-=U*n),new y(1e3*_,0,F*t)}function x(w,E,F,_,U,K){return function(I,m){var S=h(this);I=I||new Array(8),D(I,m|=0);var N=Math.floor(S.time/1e3),S=S.year*(r*e/t),p=l(S/s)+l(N/s),S=S%s+N%s,N=Math.floor(S/s);return N&&(p+=N,S-=N*s),A(I,m+U,p),A(I,m+K,S),I};function A(I,m,p){I[m+w]=p>>24&255,I[m+E]=p>>16&255,I[m+F]=p>>8&255,I[m+_]=255&p}}function P(w,E,F,_,U,K){return function(I,m){D(I,m|=0);var p=A(I,m+U);return C(A(I,m+K),p)};function A(I,m){return 16777216*I[m+w]+(I[m+E]<<16|I[m+F]<<8|I[m+_])}}function D(w,E){if(w=w&&w.length,w==null)throw new TypeError("Invalid Buffer");if(w<E+8)throw new RangeError("Out of range")}function k(w){return(9<w?"":"0")+(0|w)}function R(w,E){return(c+(0|w)).substr(-E)}}()});var Vu=_s((i2,ls)=>{"use strict";var Pp=Object.prototype.hasOwnProperty,It="~";function Xr(){}Object.create&&(Xr.prototype=Object.create(null),new Xr().__proto__||(It=!1));function Rp(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function Mu(e,t,r,n,o){if(typeof r!="function")throw new TypeError("The listener must be a function");var i=new Rp(r,n||e,o),s=It?It+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],i]:e._events[s].push(i):(e._events[s]=i,e._eventsCount++),e}function co(e,t){--e._eventsCount===0?e._events=new Xr:delete e._events[t]}function St(){this._events=new Xr,this._eventsCount=0}St.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)Pp.call(r,n)&&t.push(It?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};St.prototype.listeners=function(t){var r=It?It+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,s=new Array(i);o<i;o++)s[o]=n[o].fn;return s};St.prototype.listenerCount=function(t){var r=It?It+t:t,n=this._events[r];return n?n.fn?1:n.length:0};St.prototype.emit=function(t,r,n,o,i,s){var a=It?It+t:t;if(!this._events[a])return!1;var c=this._events[a],l=arguments.length,u,f;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,o),!0;case 5:return c.fn.call(c.context,r,n,o,i),!0;case 6:return c.fn.call(c.context,r,n,o,i,s),!0}for(f=1,u=new Array(l-1);f<l;f++)u[f-1]=arguments[f];c.fn.apply(c.context,u)}else{var d=c.length,b;for(f=0;f<d;f++)switch(c[f].once&&this.removeListener(t,c[f].fn,void 0,!0),l){case 1:c[f].fn.call(c[f].context);break;case 2:c[f].fn.call(c[f].context,r);break;case 3:c[f].fn.call(c[f].context,r,n);break;case 4:c[f].fn.call(c[f].context,r,n,o);break;default:if(!u)for(b=1,u=new Array(l-1);b<l;b++)u[b-1]=arguments[b];c[f].fn.apply(c[f].context,u)}}return!0};St.prototype.on=function(t,r,n){return Mu(this,t,r,n,!1)};St.prototype.once=function(t,r,n){return Mu(this,t,r,n,!0)};St.prototype.removeListener=function(t,r,n,o){var i=It?It+t:t;if(!this._events[i])return this;if(!r)return co(this,i),this;var s=this._events[i];if(s.fn)s.fn===r&&(!o||s.once)&&(!n||s.context===n)&&co(this,i);else{for(var a=0,c=[],l=s.length;a<l;a++)(s[a].fn!==r||o&&!s[a].once||n&&s[a].context!==n)&&c.push(s[a]);c.length?this._events[i]=c.length===1?c[0]:c:co(this,i)}return this};St.prototype.removeAllListeners=function(t){var r;return t?(r=It?It+t:t,this._events[r]&&co(this,r)):(this._events=new Xr,this._eventsCount=0),this};St.prototype.off=St.prototype.removeListener;St.prototype.addListener=St.prototype.on;St.prefixed=It;St.EventEmitter=St;typeof ls<"u"&&(ls.exports=St)});var Qp={};At(Qp,{delegatedHTTPRouting:()=>Wu,delegatedHTTPRoutingDefaults:()=>go,httpGatewayRouting:()=>nf,libp2pRouting:()=>of});var ks=Symbol.for("@libp2p/content-routing");var bo=Symbol.for("@libp2p/peer-id");var Ds=Symbol.for("@libp2p/peer-routing");var xt=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},je=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var Bt=class extends Error{static name="NotFoundError";constructor(t="Not found"){super(t),this.name="NotFoundError"}};var rn=class extends Error{static name="InvalidCIDError";constructor(t="Invalid CID"){super(t),this.name="InvalidCIDError"}},Ze=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var We=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Io={};At(Io,{base32:()=>Kt,base32hex:()=>Cf,base32hexpad:()=>Nf,base32hexpadupper:()=>Pf,base32hexupper:()=>Uf,base32pad:()=>Tf,base32padupper:()=>Bf,base32upper:()=>If,base32z:()=>Rf});var i0=new Uint8Array(0);function Fs(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function ae(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function Os(e){return new TextEncoder().encode(e)}function Ms(e){return new TextDecoder().decode(e)}function bf(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(r[s]!==255)throw new TypeError(i+" is ambiguous");r[s]=o}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var y=0,h=0,v=0,C=T.length;v!==C&&T[v]===0;)v++,y++;for(var x=(C-v)*u+1>>>0,P=new Uint8Array(x);v!==C;){for(var D=T[v],k=0,R=x-1;(D!==0||k<h)&&R!==-1;R--,k++)D+=256*P[R]>>>0,P[R]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");h=k,v++}for(var w=x-h;w!==x&&P[w]===0;)w++;for(var E=c.repeat(y);w<x;++w)E+=e.charAt(P[w]);return E}function d(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var y=0;if(T[y]!==" "){for(var h=0,v=0;T[y]===c;)h++,y++;for(var C=(T.length-y)*l+1>>>0,x=new Uint8Array(C);T[y];){var P=r[T.charCodeAt(y)];if(P===255)return;for(var D=0,k=C-1;(P!==0||D<v)&&k!==-1;k--,D++)P+=a*x[k]>>>0,x[k]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");v=D,y++}if(T[y]!==" "){for(var R=C-v;R!==C&&x[R]===0;)R++;for(var w=new Uint8Array(h+(C-R)),E=h;R!==C;)w[E++]=x[R++];return w}}}function b(T){var y=d(T);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:f,decodeUnsafe:d,decode:b}}var Ef=bf,Sf=Ef,Ks=Sf;var Eo=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},So=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;let o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return qs(this,t)}},vo=class{decoders;constructor(t){this.decoders=t}or(t){return qs(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function qs(e,t){return new vo({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}var Ao=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Eo(t,r,n),this.decoder=new So(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function Ye({name:e,prefix:t,encode:r,decode:n}){return new Ao(e,t,r,n)}function xe({name:e,prefix:t,alphabet:r}){let{encode:n,decode:o}=Ks(r,e);return Ye({prefix:t,name:e,encode:n,decode:i=>ae(o(i))})}function vf(e,t,r,n){let o={};for(let u=0;u<t.length;++u)o[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;let s=new Uint8Array(i*r/8|0),a=0,c=0,l=0;for(let u=0;u<i;++u){let f=o[e[u]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=r||(255&c<<8-a)!==0)throw new SyntaxError("Unexpected end of data");return s}function Af(e,t,r){let n=t[t.length-1]==="=",o=(1<<r)-1,i="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>r;)s-=r,i+=t[o&a>>s];if(s!==0&&(i+=t[o&a<<r-s]),n)for(;(i.length*r&7)!==0;)i+="=";return i}function st({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return Ye({prefix:t,name:e,encode(o){return Af(o,n,r)},decode(o){return vf(o,n,r,e)}})}var Kt=st({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),If=st({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Tf=st({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bf=st({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Cf=st({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Uf=st({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Nf=st({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Pf=st({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Rf=st({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var To={};At(To,{base58btc:()=>et,base58flickr:()=>_f});var et=xe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_f=xe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Co={};At(Co,{base64:()=>Bo,base64pad:()=>Lf,base64url:()=>kf,base64urlpad:()=>Df});var Bo=st({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Lf=st({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kf=st({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Df=st({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Ff(e,t){try{if(typeof e=="string"&&e.length>0)return Of(e);if(typeof e=="number"&&isFinite(e))return t?.long?Vf(e):Mf(e);throw new Error("Value is not a string or number.")}catch(r){let n=Kf(r)?`${r.message}. value=${JSON.stringify(e)}`:"An unknown error has occured.";throw new Error(n)}}function Of(e){if(e=String(e),e.length>100)throw new Error("Value exceeds the maximum length of 100 characters.");let t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return NaN;let r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*315576e5;case"weeks":case"week":case"w":return r*6048e5;case"days":case"day":case"d":return r*864e5;case"hours":case"hour":case"hrs":case"hr":case"h":return r*36e5;case"minutes":case"minute":case"mins":case"min":case"m":return r*6e4;case"seconds":case"second":case"secs":case"sec":case"s":return r*1e3;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:throw new Error(`The unit ${n} was matched, but no matching case exists.`)}}var on=Ff;function Mf(e){let t=Math.abs(e);return t>=864e5?`${Math.round(e/864e5)}d`:t>=36e5?`${Math.round(e/36e5)}h`:t>=6e4?`${Math.round(e/6e4)}m`:t>=1e3?`${Math.round(e/1e3)}s`:`${e}ms`}function Vf(e){let t=Math.abs(e);return t>=864e5?nn(e,t,864e5,"day"):t>=36e5?nn(e,t,36e5,"hour"):t>=6e4?nn(e,t,6e4,"minute"):t>=1e3?nn(e,t,1e3,"second"):`${e} ms`}function nn(e,t,r,n){let o=t>=r*1.5;return`${Math.round(e/r)} ${n}${o?"s":""}`}function Kf(e){return typeof e=="object"&&e!==null&&"message"in e}function Uo(e){r.debug=r,r.default=r,r.coerce=c,r.disable=i,r.enable=o,r.enabled=s,r.humanize=on,r.destroy=l,Object.keys(e).forEach(u=>{r[u]=e[u]}),r.names=[],r.skips=[],r.formatters={};function t(u){let f=0;for(let d=0;d<u.length;d++)f=(f<<5)-f+u.charCodeAt(d),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=t;function r(u){let f,d=null,b,T;function y(...h){if(!y.enabled)return;let v=y,C=Number(new Date),x=C-(f||C);v.diff=x,v.prev=f,v.curr=C,f=C,h[0]=r.coerce(h[0]),typeof h[0]!="string"&&h.unshift("%O");let P=0;h[0]=h[0].replace(/%([a-zA-Z%])/g,(k,R)=>{if(k==="%%")return"%";P++;let w=r.formatters[R];if(typeof w=="function"){let E=h[P];k=w.call(v,E),h.splice(P,1),P--}return k}),r.formatArgs.call(v,h),(v.log||r.log).apply(v,h)}return y.namespace=u,y.useColors=r.useColors(),y.color=r.selectColor(u),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(b!==r.namespaces&&(b=r.namespaces,T=r.enabled(u)),T),set:h=>{d=h}}),typeof r.init=="function"&&r.init(y),y}function n(u,f){let d=r(this.namespace+(typeof f>"u"?":":f)+u);return d.log=this.log,d}function o(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let f,d=(typeof u=="string"?u:"").split(/[\s,]+/),b=d.length;for(f=0;f<b;f++)d[f]&&(u=d[f].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.substr(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function i(){let u=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let f,d;for(f=0,d=r.skips.length;f<d;f++)if(r.skips[f].test(u))return!1;for(f=0,d=r.names.length;f<d;f++)if(r.names[f].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack??u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.setupFormatters(r.formatters),r.enable(r.load()),r}var sn=Zf(),qf=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function $f(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/(edge|trident)\/(\d+)/)!=null?!1:typeof document<"u"&&document.documentElement?.style?.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/firefox\/(\d+)/)!=null&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/applewebkit\/(\d+)/)}function zf(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+on(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),e.splice(n,0,t)}var Hf=console.debug??console.log??(()=>{});function Gf(e){try{e?sn?.setItem("debug",e):sn?.removeItem("debug")}catch{}}function jf(){let e;try{e=sn?.getItem("debug")}catch{}return!e&&typeof globalThis.process<"u"&&"env"in globalThis.process&&(e=globalThis.process.env.DEBUG),e}function Zf(){try{return localStorage}catch{}}function Wf(e){e.j=function(t){try{return JSON.stringify(t)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}}var $s=Uo({formatArgs:zf,save:Gf,load:jf,useColors:$f,setupFormatters:Wf,colors:qf,storage:sn,log:Hf});var Ct=$s;Ct.formatters.b=e=>e==null?"undefined":et.baseEncode(e);Ct.formatters.t=e=>e==null?"undefined":Kt.baseEncode(e);Ct.formatters.m=e=>e==null?"undefined":Bo.baseEncode(e);Ct.formatters.p=e=>e==null?"undefined":e.toString();Ct.formatters.c=e=>e==null?"undefined":e.toString();Ct.formatters.k=e=>e==null?"undefined":e.toString();Ct.formatters.a=e=>e==null?"undefined":e.toString();Ct.formatters.e=e=>e==null?"undefined":zs(e.stack)??zs(e.message)??e.toString();function Yf(e){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function we(e){let t=Yf(`${e}:trace`);return Ct.enabled(`${e}:trace`)&&Ct.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=Ct(`${e}:trace`)),Object.assign(Ct(e),{error:Ct(`${e}:error`),trace:t})}function zs(e){if(e!=null&&(e=e.trim(),e.length!==0))return e}var No={};At(No,{base36:()=>Xe,base36upper:()=>Xf});var Xe=xe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xf=xe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Jf=js,Hs=128,Qf=127,tl=~Qf,el=Math.pow(2,31);function js(e,t,r){t=t||[],r=r||0;for(var n=r;e>=el;)t[r++]=e&255|Hs,e/=128;for(;e&tl;)t[r++]=e&255|Hs,e>>>=7;return t[r]=e|0,js.bytes=r-n+1,t}var rl=Po,nl=128,Gs=127;function Po(e,n){var r=0,n=n||0,o=0,i=n,s,a=e.length;do{if(i>=a)throw Po.bytes=0,new RangeError("Could not decode varint");s=e[i++],r+=o<28?(s&Gs)<<o:(s&Gs)*Math.pow(2,o),o+=7}while(s>=nl);return Po.bytes=i-n,r}var ol=Math.pow(2,7),il=Math.pow(2,14),sl=Math.pow(2,21),al=Math.pow(2,28),cl=Math.pow(2,35),ul=Math.pow(2,42),fl=Math.pow(2,49),ll=Math.pow(2,56),dl=Math.pow(2,63),hl=function(e){return e<ol?1:e<il?2:e<sl?3:e<al?4:e<cl?5:e<ul?6:e<fl?7:e<ll?8:e<dl?9:10},pl={encode:Jf,decode:rl,encodingLength:hl},ml=pl,Ir=ml;function Tr(e,t=0){return[Ir.decode(e,t),Ir.decode.bytes]}function Je(e,t,r=0){return Ir.encode(e,t,r),t}function Qe(e){return Ir.encodingLength(e)}function qt(e,t){let r=t.byteLength,n=Qe(e),o=n+Qe(r),i=new Uint8Array(o+r);return Je(e,i,0),Je(r,i,n),i.set(t,o),new tr(e,r,t,i)}function ce(e){let t=ae(e),[r,n]=Tr(t),[o,i]=Tr(t.subarray(n)),s=t.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new tr(r,o,s,t)}function Zs(e,t){if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Fs(e.bytes,r.bytes)}}var tr=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function Ws(e,t){let{bytes:r,version:n}=e;switch(n){case 0:return yl(r,Ro(e),t??et.encoder);default:return xl(r,Ro(e),t??Kt.encoder)}}var Ys=new WeakMap;function Ro(e){let t=Ys.get(e);if(t==null){let r=new Map;return Ys.set(e,r),r}return t}var W=class e{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==Br)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==wl)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=qt(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n!=null&&t.code===n.code&&t.version===n.version&&Zs(t.multihash,n.multihash)}toString(t){return Ws(this,t)}toJSON(){return{"/":Ws(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:i,bytes:s}=r;return new e(n,o,i,s??Xs(n,o,i.bytes))}else if(r[bl]===!0){let{version:n,multihash:o,code:i}=r,s=ce(o);return e.create(n,i,s)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==Br)throw new Error(`Version 0 CID must use dag-pb (code: ${Br}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let o=Xs(t,r,n.bytes);return new e(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,Br,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,o=ae(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=o.subarray(r.multihashSize-r.digestSize),s=new tr(r.multihashCode,r.digestSize,i,o);return[r.version===0?e.createV0(s):e.createV1(r.codec,s),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[f,d]=Tr(t.subarray(r));return r+=d,f},o=n(),i=Br;if(o===18?(o=0,r=0):i=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let s=r,a=n(),c=n(),l=r+c,u=l-s;return{version:o,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:l}}static parse(t,r){let[n,o]=gl(t,r),i=e.decode(o);if(i.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ro(i).set(n,t),i}};function gl(e,t){switch(e[0]){case"Q":{let r=t??et;return[et.prefix,r.decode(`${et.prefix}${e}`)]}case et.prefix:{let r=t??et;return[et.prefix,r.decode(e)]}case Kt.prefix:{let r=t??Kt;return[Kt.prefix,r.decode(e)]}case Xe.prefix:{let r=t??Xe;return[Xe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function yl(e,t,r){let{prefix:n}=r;if(n!==et.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let i=r.encode(e).slice(1);return t.set(n,i),i}else return o}function xl(e,t,r){let{prefix:n}=r,o=t.get(n);if(o==null){let i=r.encode(e);return t.set(n,i),i}else return o}var Br=112,wl=18;function Xs(e,t,r){let n=Qe(e),o=n+Qe(t),i=new Uint8Array(o+r.byteLength);return Je(e,i,0),Je(t,i,n),i.set(r,o),i}var bl=Symbol.for("@ipld/js-cid/CID");var _o={};At(_o,{identity:()=>$t});var Js=0,El="identity",Qs=ae;function Sl(e){return qt(Js,Qs(e))}var $t={code:Js,name:El,encode:Qs,digest:Sl};function ot(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function ta(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function vl(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function er(e,...t){if(!vl(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ea(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ta(e.outputLen),ta(e.blockLen)}function rr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ra(e,t){er(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}var Le=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function cn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zt(e,t){return e<<32-t|e>>>t}function na(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Cr(e){return typeof e=="string"&&(e=na(e)),er(e),e}function Lo(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];er(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let i=e[n];r.set(i,o),o+=i.length}return r}var nr=class{clone(){return this._cloneInto()}};function un(e){let t=n=>e().update(Cr(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function fn(e=32){if(Le&&typeof Le.getRandomValues=="function")return Le.getRandomValues(new Uint8Array(e));if(Le&&typeof Le.randomBytes=="function")return Le.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function Al(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),a=Number(r&i),c=n?4:0,l=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+l,a,n)}function oa(e,t,r){return e&t^~e&r}function ia(e,t,r){return e&t^e&r^t&r}var or=class extends nr{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=cn(this.buffer)}update(t){rr(this);let{view:r,buffer:n,blockLen:o}=this;t=Cr(t);let i=t.length;for(let s=0;s<i;){let a=Math.min(o-this.pos,i-s);if(a===o){let c=cn(t);for(;o<=i-s;s+=o)this.process(c,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){rr(this),ra(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(n,0),s=0);for(let f=s;f<o;f++)r[f]=0;Al(n,o-8,BigInt(this.length*8),i),this.process(n,0);let a=cn(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)a.setUint32(4*f,u[f],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:s,pos:a}=this;return t.length=o,t.pos=a,t.finished=i,t.destroyed=s,o%r&&t.buffer.set(n),t}};var ln=BigInt(4294967295),ko=BigInt(32);function sa(e,t=!1){return t?{h:Number(e&ln),l:Number(e>>ko&ln)}:{h:Number(e>>ko&ln)|0,l:Number(e&ln)|0}}function Il(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:i,l:s}=sa(e[o],t);[r[o],n[o]]=[i,s]}return[r,n]}var Tl=(e,t)=>BigInt(e>>>0)<<ko|BigInt(t>>>0),Bl=(e,t,r)=>e>>>r,Cl=(e,t,r)=>e<<32-r|t>>>r,Ul=(e,t,r)=>e>>>r|t<<32-r,Nl=(e,t,r)=>e<<32-r|t>>>r,Pl=(e,t,r)=>e<<64-r|t>>>r-32,Rl=(e,t,r)=>e>>>r-32|t<<64-r,_l=(e,t)=>t,Ll=(e,t)=>e,kl=(e,t,r)=>e<<r|t>>>32-r,Dl=(e,t,r)=>t<<r|e>>>32-r,Fl=(e,t,r)=>t<<r-32|e>>>64-r,Ol=(e,t,r)=>e<<r-32|t>>>64-r;function Ml(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}var Vl=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Kl=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,ql=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),$l=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,zl=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),Hl=(e,t,r,n,o,i)=>t+r+n+o+i+(e/2**32|0)|0;var Gl={fromBig:sa,split:Il,toBig:Tl,shrSH:Bl,shrSL:Cl,rotrSH:Ul,rotrSL:Nl,rotrBH:Pl,rotrBL:Rl,rotr32H:_l,rotr32L:Ll,rotlSH:kl,rotlSL:Dl,rotlBH:Fl,rotlBL:Ol,add:Ml,add3L:Vl,add3H:Kl,add4L:ql,add4H:$l,add5H:Hl,add5L:zl},$=Gl;var[jl,Zl]=$.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Ee=new Uint32Array(80),Se=new Uint32Array(80),Do=class extends or{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:i,Cl:s,Dh:a,Dl:c,Eh:l,El:u,Fh:f,Fl:d,Gh:b,Gl:T,Hh:y,Hl:h}=this;return[t,r,n,o,i,s,a,c,l,u,f,d,b,T,y,h]}set(t,r,n,o,i,s,a,c,l,u,f,d,b,T,y,h){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=i|0,this.Cl=s|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=f|0,this.Fl=d|0,this.Gh=b|0,this.Gl=T|0,this.Hh=y|0,this.Hl=h|0}process(t,r){for(let x=0;x<16;x++,r+=4)Ee[x]=t.getUint32(r),Se[x]=t.getUint32(r+=4);for(let x=16;x<80;x++){let P=Ee[x-15]|0,D=Se[x-15]|0,k=$.rotrSH(P,D,1)^$.rotrSH(P,D,8)^$.shrSH(P,D,7),R=$.rotrSL(P,D,1)^$.rotrSL(P,D,8)^$.shrSL(P,D,7),w=Ee[x-2]|0,E=Se[x-2]|0,F=$.rotrSH(w,E,19)^$.rotrBH(w,E,61)^$.shrSH(w,E,6),_=$.rotrSL(w,E,19)^$.rotrBL(w,E,61)^$.shrSL(w,E,6),U=$.add4L(R,_,Se[x-7],Se[x-16]),K=$.add4H(U,k,F,Ee[x-7],Ee[x-16]);Ee[x]=K|0,Se[x]=U|0}let{Ah:n,Al:o,Bh:i,Bl:s,Ch:a,Cl:c,Dh:l,Dl:u,Eh:f,El:d,Fh:b,Fl:T,Gh:y,Gl:h,Hh:v,Hl:C}=this;for(let x=0;x<80;x++){let P=$.rotrSH(f,d,14)^$.rotrSH(f,d,18)^$.rotrBH(f,d,41),D=$.rotrSL(f,d,14)^$.rotrSL(f,d,18)^$.rotrBL(f,d,41),k=f&b^~f&y,R=d&T^~d&h,w=$.add5L(C,D,R,Zl[x],Se[x]),E=$.add5H(w,v,P,k,jl[x],Ee[x]),F=w|0,_=$.rotrSH(n,o,28)^$.rotrBH(n,o,34)^$.rotrBH(n,o,39),U=$.rotrSL(n,o,28)^$.rotrBL(n,o,34)^$.rotrBL(n,o,39),K=n&i^n&a^i&a,A=o&s^o&c^s&c;v=y|0,C=h|0,y=b|0,h=T|0,b=f|0,T=d|0,{h:f,l:d}=$.add(l|0,u|0,E|0,F|0),l=a|0,u=c|0,a=i|0,c=s|0,i=n|0,s=o|0;let I=$.add3L(F,U,A);n=$.add3H(I,E,_,K),o=I|0}({h:n,l:o}=$.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:i,l:s}=$.add(this.Bh|0,this.Bl|0,i|0,s|0),{h:a,l:c}=$.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=$.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:f,l:d}=$.add(this.Eh|0,this.El|0,f|0,d|0),{h:b,l:T}=$.add(this.Fh|0,this.Fl|0,b|0,T|0),{h:y,l:h}=$.add(this.Gh|0,this.Gl|0,y|0,h|0),{h:v,l:C}=$.add(this.Hh|0,this.Hl|0,v|0,C|0),this.set(n,o,i,s,a,c,l,u,f,d,b,T,y,h,v,C)}roundClean(){Ee.fill(0),Se.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var aa=un(()=>new Do);var pn={};At(pn,{aInRange:()=>Ut,abool:()=>Ht,abytes:()=>ir,bitGet:()=>td,bitLen:()=>Vo,bitMask:()=>Nr,bitSet:()=>ed,bytesToHex:()=>fe,bytesToNumberBE:()=>le,bytesToNumberLE:()=>Ae,concatBytes:()=>de,createHmacDrbg:()=>Ko,ensureBytes:()=>it,equalBytes:()=>Jl,hexToBytes:()=>De,hexToNumber:()=>Mo,inRange:()=>Ur,isBytes:()=>ve,memoized:()=>Oe,notImplemented:()=>nd,numberToBytesBE:()=>Ie,numberToBytesLE:()=>Fe,numberToHexUnpadded:()=>ke,numberToVarBytesBE:()=>Xl,utf8ToBytes:()=>Ql,validateObject:()=>re});var dn=BigInt(0),hn=BigInt(1),Wl=BigInt(2);function ve(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ir(e){if(!ve(e))throw new Error("Uint8Array expected")}function Ht(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}var Yl=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function fe(e){ir(e);let t="";for(let r=0;r<e.length;r++)t+=Yl[e[r]];return t}function ke(e){let t=e.toString(16);return t.length&1?"0"+t:t}function Mo(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?dn:BigInt("0x"+e)}var ue={_0:48,_9:57,A:65,F:70,a:97,f:102};function ca(e){if(e>=ue._0&&e<=ue._9)return e-ue._0;if(e>=ue.A&&e<=ue.F)return e-(ue.A-10);if(e>=ue.a&&e<=ue.f)return e-(ue.a-10)}function De(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,i=0;o<r;o++,i+=2){let s=ca(e.charCodeAt(i)),a=ca(e.charCodeAt(i+1));if(s===void 0||a===void 0){let c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[o]=s*16+a}return n}function le(e){return Mo(fe(e))}function Ae(e){return ir(e),Mo(fe(Uint8Array.from(e).reverse()))}function Ie(e,t){return De(e.toString(16).padStart(t*2,"0"))}function Fe(e,t){return Ie(e,t).reverse()}function Xl(e){return De(ke(e))}function it(e,t,r){let n;if(typeof t=="string")try{n=De(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(ve(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(e+" of length "+r+" expected, got "+o);return n}function de(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];ir(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let i=e[n];r.set(i,o),o+=i.length}return r}function Jl(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}function Ql(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}var Fo=e=>typeof e=="bigint"&&dn<=e;function Ur(e,t,r){return Fo(e)&&Fo(t)&&Fo(r)&&t<=e&&e<r}function Ut(e,t,r,n){if(!Ur(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function Vo(e){let t;for(t=0;e>dn;e>>=hn,t+=1);return t}function td(e,t){return e>>BigInt(t)&hn}function ed(e,t,r){return e|(r?hn:dn)<<BigInt(t)}var Nr=e=>(Wl<<BigInt(e-1))-hn,Oo=e=>new Uint8Array(e),ua=e=>Uint8Array.from(e);function Ko(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Oo(e),o=Oo(e),i=0,s=()=>{n.fill(1),o.fill(0),i=0},a=(...f)=>r(o,n,...f),c=(f=Oo())=>{o=a(ua([0]),f),n=a(),f.length!==0&&(o=a(ua([1]),f),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,d=[];for(;f<t;){n=a();let b=n.slice();d.push(b),f+=n.length}return de(...d)};return(f,d)=>{s(),c(f);let b;for(;!(b=d(l()));)c();return s(),b}}var rd={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||ve(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function re(e,t,r={}){let n=(o,i,s)=>{let a=rd[i];if(typeof a!="function")throw new Error("invalid validator function");let c=e[o];if(!(s&&c===void 0)&&!a(c,e))throw new Error("param "+String(o)+" is invalid. Expected "+i+", got "+c)};for(let[o,i]of Object.entries(t))n(o,i,!1);for(let[o,i]of Object.entries(r))n(o,i,!0);return e}var nd=()=>{throw new Error("not implemented")};function Oe(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let i=e(r,...n);return t.set(r,i),i}}var ct=BigInt(0),rt=BigInt(1),Me=BigInt(2),od=BigInt(3),qo=BigInt(4),fa=BigInt(5),la=BigInt(8),id=BigInt(9),sd=BigInt(16);function J(e,t){let r=e%t;return r>=ct?r:t+r}function ad(e,t,r){if(t<ct)throw new Error("invalid exponent, negatives unsupported");if(r<=ct)throw new Error("invalid modulus");if(r===rt)return ct;let n=rt;for(;t>ct;)t&rt&&(n=n*e%r),e=e*e%r,t>>=rt;return n}function nt(e,t,r){let n=e;for(;t-- >ct;)n*=n,n%=r;return n}function mn(e,t){if(e===ct)throw new Error("invert: expected non-zero number");if(t<=ct)throw new Error("invert: expected positive modulus, got "+t);let r=J(e,t),n=t,o=ct,i=rt,s=rt,a=ct;for(;r!==ct;){let l=n/r,u=n%r,f=o-s*l,d=i-a*l;n=r,r=u,o=s,i=a,s=f,a=d}if(n!==rt)throw new Error("invert: does not exist");return J(o,t)}function cd(e){let t=(e-rt)/Me,r,n,o;for(r=e-rt,n=0;r%Me===ct;r/=Me,n++);for(o=Me;o<e&&ad(o,t,e)!==e-rt;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){let s=(e+rt)/qo;return function(c,l){let u=c.pow(l,s);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}let i=(r+rt)/Me;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,u=a.pow(a.mul(a.ONE,o),r),f=a.pow(c,i),d=a.pow(c,r);for(;!a.eql(d,a.ONE);){if(a.eql(d,a.ZERO))return a.ZERO;let b=1;for(let y=a.sqr(d);b<l&&!a.eql(y,a.ONE);b++)y=a.sqr(y);let T=a.pow(u,rt<<BigInt(l-b-1));u=a.sqr(T),f=a.mul(f,T),d=a.mul(d,u),l=b}return f}}function ud(e){if(e%qo===od){let t=(e+rt)/qo;return function(n,o){let i=n.pow(o,t);if(!n.eql(n.sqr(i),o))throw new Error("Cannot find square root");return i}}if(e%la===fa){let t=(e-fa)/la;return function(n,o){let i=n.mul(o,Me),s=n.pow(i,t),a=n.mul(o,s),c=n.mul(n.mul(a,Me),s),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),o))throw new Error("Cannot find square root");return l}}return e%sd,cd(e)}var da=(e,t)=>(J(e,t)&rt)===rt,fd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function $o(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=fd.reduce((n,o)=>(n[o]="function",n),t);return re(e,r)}function ld(e,t,r){if(r<ct)throw new Error("invalid exponent, negatives unsupported");if(r===ct)return e.ONE;if(r===rt)return t;let n=e.ONE,o=t;for(;r>ct;)r&rt&&(n=e.mul(n,o)),o=e.sqr(o),r>>=rt;return n}function dd(e,t){let r=new Array(t.length),n=t.reduce((i,s,a)=>e.is0(s)?i:(r[a]=i,e.mul(i,s)),e.ONE),o=e.inv(n);return t.reduceRight((i,s,a)=>e.is0(s)?i:(r[a]=e.mul(i,r[a]),e.mul(i,s)),o),r}function zo(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Te(e,t,r=!1,n={}){if(e<=ct)throw new Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:o,nByteLength:i}=zo(e,t);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s,a=Object.freeze({ORDER:e,isLE:r,BITS:o,BYTES:i,MASK:Nr(o),ZERO:ct,ONE:rt,create:c=>J(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return ct<=c&&c<e},is0:c=>c===ct,isOdd:c=>(c&rt)===rt,neg:c=>J(-c,e),eql:(c,l)=>c===l,sqr:c=>J(c*c,e),add:(c,l)=>J(c+l,e),sub:(c,l)=>J(c-l,e),mul:(c,l)=>J(c*l,e),pow:(c,l)=>ld(a,c,l),div:(c,l)=>J(c*mn(l,e),e),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>mn(c,e),sqrt:n.sqrt||(c=>(s||(s=ud(e)),s(a,c))),invertBatch:c=>dd(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?Fe(c,i):Ie(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?Ae(c):le(c)}});return Object.freeze(a)}function ha(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Ho(e){let t=ha(e);return t+Math.ceil(t/2)}function pa(e,t,r=!1){let n=e.length,o=ha(t),i=Ho(t);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);let s=r?Ae(e):le(e),a=J(s,t-rt)+rt;return r?Fe(a,o):Ie(a,o)}var ma=BigInt(0),gn=BigInt(1);function Go(e,t){let r=t.negate();return e?r:t}function ga(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function jo(e,t){ga(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1);return{windows:r,windowSize:n}}function hd(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function pd(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}var Zo=new WeakMap,ya=new WeakMap;function Wo(e){return ya.get(e)||1}function yn(e,t){return{constTimeNegate:Go,hasPrecomputes(r){return Wo(r)!==1},unsafeLadder(r,n,o=e.ZERO){let i=r;for(;n>ma;)n&gn&&(o=o.add(i)),i=i.double(),n>>=gn;return o},precomputeWindow(r,n){let{windows:o,windowSize:i}=jo(n,t),s=[],a=r,c=a;for(let l=0;l<o;l++){c=a,s.push(c);for(let u=1;u<i;u++)c=c.add(a),s.push(c);a=c.double()}return s},wNAF(r,n,o){let{windows:i,windowSize:s}=jo(r,t),a=e.ZERO,c=e.BASE,l=BigInt(2**r-1),u=2**r,f=BigInt(r);for(let d=0;d<i;d++){let b=d*s,T=Number(o&l);o>>=f,T>s&&(T-=u,o+=gn);let y=b,h=b+Math.abs(T)-1,v=d%2!==0,C=T<0;T===0?c=c.add(Go(v,n[y])):a=a.add(Go(C,n[h]))}return{p:a,f:c}},wNAFUnsafe(r,n,o,i=e.ZERO){let{windows:s,windowSize:a}=jo(r,t),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let f=0;f<s;f++){let d=f*a;if(o===ma)break;let b=Number(o&c);if(o>>=u,b>a&&(b-=l,o+=gn),b===0)continue;let T=n[d+Math.abs(b)-1];b<0&&(T=T.negate()),i=i.add(T)}return i},getPrecomputes(r,n,o){let i=Zo.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&Zo.set(n,o(i))),i},wNAFCached(r,n,o){let i=Wo(r);return this.wNAF(i,this.getPrecomputes(i,r,o),n)},wNAFCachedUnsafe(r,n,o,i){let s=Wo(r);return s===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(s,this.getPrecomputes(s,r,o),n,i)},setWindowSize(r,n){ga(n,t),ya.set(r,n),Zo.delete(r)}}}function xn(e,t,r,n){if(hd(r,e),pd(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");let o=e.ZERO,i=Vo(BigInt(r.length)),s=i>12?i-3:i>4?i-2:i?2:1,a=(1<<s)-1,c=new Array(a+1).fill(o),l=Math.floor((t.BITS-1)/s)*s,u=o;for(let f=l;f>=0;f-=s){c.fill(o);for(let b=0;b<n.length;b++){let T=n[b],y=Number(T>>BigInt(f)&BigInt(a));c[y]=c[y].add(r[b])}let d=o;for(let b=c.length-1,T=o;b>0;b--)T=T.add(c[b]),d=d.add(T);if(u=u.add(d),f!==0)for(let b=0;b<s;b++)u=u.double()}return u}function Pr(e){return $o(e.Fp),re(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...zo(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var Gt=BigInt(0),Nt=BigInt(1),wn=BigInt(2),md=BigInt(8),gd={zip215:!0};function yd(e){let t=Pr(e);return re(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function xa(e){let t=yd(e),{Fp:r,n,prehash:o,hash:i,randomBytes:s,nByteLength:a,h:c}=t,l=wn<<BigInt(a*8)-Nt,u=r.create,f=Te(t.n,t.nBitLength),d=t.uvRatio||((m,p)=>{try{return{isValid:!0,value:r.sqrt(m*r.inv(p))}}catch{return{isValid:!1,value:Gt}}}),b=t.adjustScalarBytes||(m=>m),T=t.domain||((m,p,S)=>{if(Ht("phflag",S),p.length||S)throw new Error("Contexts/pre-hash are not supported");return m});function y(m,p){Ut("coordinate "+m,p,Gt,l)}function h(m){if(!(m instanceof x))throw new Error("ExtendedPoint expected")}let v=Oe((m,p)=>{let{ex:S,ey:N,ez:O}=m,M=m.is0();p==null&&(p=M?md:r.inv(O));let z=u(S*p),j=u(N*p),q=u(O*p);if(M)return{x:Gt,y:Nt};if(q!==Nt)throw new Error("invZ was invalid");return{x:z,y:j}}),C=Oe(m=>{let{a:p,d:S}=t;if(m.is0())throw new Error("bad point: ZERO");let{ex:N,ey:O,ez:M,et:z}=m,j=u(N*N),q=u(O*O),X=u(M*M),tt=u(X*X),ft=u(j*p),lt=u(X*u(ft+q)),mt=u(tt+u(S*u(j*q)));if(lt!==mt)throw new Error("bad point: equation left != right (1)");let yt=u(N*O),Tt=u(M*z);if(yt!==Tt)throw new Error("bad point: equation left != right (2)");return!0});class x{constructor(p,S,N,O){this.ex=p,this.ey=S,this.ez=N,this.et=O,y("x",p),y("y",S),y("z",N),y("t",O),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(p){if(p instanceof x)throw new Error("extended point not allowed");let{x:S,y:N}=p||{};return y("x",S),y("y",N),new x(S,N,Nt,u(S*N))}static normalizeZ(p){let S=r.invertBatch(p.map(N=>N.ez));return p.map((N,O)=>N.toAffine(S[O])).map(x.fromAffine)}static msm(p,S){return xn(x,f,p,S)}_setWindowSize(p){k.setWindowSize(this,p)}assertValidity(){C(this)}equals(p){h(p);let{ex:S,ey:N,ez:O}=this,{ex:M,ey:z,ez:j}=p,q=u(S*j),X=u(M*O),tt=u(N*j),ft=u(z*O);return q===X&&tt===ft}is0(){return this.equals(x.ZERO)}negate(){return new x(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:p}=t,{ex:S,ey:N,ez:O}=this,M=u(S*S),z=u(N*N),j=u(wn*u(O*O)),q=u(p*M),X=S+N,tt=u(u(X*X)-M-z),ft=q+z,lt=ft-j,mt=q-z,yt=u(tt*lt),Tt=u(ft*mt),vt=u(tt*mt),ee=u(lt*ft);return new x(yt,Tt,ee,vt)}add(p){h(p);let{a:S,d:N}=t,{ex:O,ey:M,ez:z,et:j}=this,{ex:q,ey:X,ez:tt,et:ft}=p;if(S===BigInt(-1)){let Ts=u((M-O)*(X+q)),Bs=u((M+O)*(X-q)),xo=u(Bs-Ts);if(xo===Gt)return this.double();let Cs=u(z*wn*ft),Us=u(j*wn*tt),Ns=Us+Cs,Ps=Bs+Ts,Rs=Us-Cs,ff=u(Ns*xo),lf=u(Ps*Rs),df=u(Ns*Rs),hf=u(xo*Ps);return new x(ff,lf,hf,df)}let lt=u(O*q),mt=u(M*X),yt=u(j*N*ft),Tt=u(z*tt),vt=u((O+M)*(q+X)-lt-mt),ee=Tt-yt,se=Tt+yt,Ar=u(mt-S*lt),sf=u(vt*ee),af=u(se*Ar),cf=u(vt*Ar),uf=u(ee*se);return new x(sf,af,uf,cf)}subtract(p){return this.add(p.negate())}wNAF(p){return k.wNAFCached(this,p,x.normalizeZ)}multiply(p){let S=p;Ut("scalar",S,Nt,n);let{p:N,f:O}=this.wNAF(S);return x.normalizeZ([N,O])[0]}multiplyUnsafe(p,S=x.ZERO){let N=p;return Ut("scalar",N,Gt,n),N===Gt?D:this.is0()||N===Nt?this:k.wNAFCachedUnsafe(this,N,x.normalizeZ,S)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return k.unsafeLadder(this,n).is0()}toAffine(p){return v(this,p)}clearCofactor(){let{h:p}=t;return p===Nt?this:this.multiplyUnsafe(p)}static fromHex(p,S=!1){let{d:N,a:O}=t,M=r.BYTES;p=it("pointHex",p,M),Ht("zip215",S);let z=p.slice(),j=p[M-1];z[M-1]=j&-129;let q=Ae(z),X=S?l:r.ORDER;Ut("pointHex.y",q,Gt,X);let tt=u(q*q),ft=u(tt-Nt),lt=u(N*tt-O),{isValid:mt,value:yt}=d(ft,lt);if(!mt)throw new Error("Point.fromHex: invalid y coordinate");let Tt=(yt&Nt)===Nt,vt=(j&128)!==0;if(!S&&yt===Gt&&vt)throw new Error("Point.fromHex: x=0 and x_0=1");return vt!==Tt&&(yt=u(-yt)),x.fromAffine({x:yt,y:q})}static fromPrivateKey(p){return E(p).point}toRawBytes(){let{x:p,y:S}=this.toAffine(),N=Fe(S,r.BYTES);return N[N.length-1]|=p&Nt?128:0,N}toHex(){return fe(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,Nt,u(t.Gx*t.Gy)),x.ZERO=new x(Gt,Nt,Nt,Gt);let{BASE:P,ZERO:D}=x,k=yn(x,a*8);function R(m){return J(m,n)}function w(m){return R(Ae(m))}function E(m){let p=r.BYTES;m=it("private key",m,p);let S=it("hashed private key",i(m),2*p),N=b(S.slice(0,p)),O=S.slice(p,2*p),M=w(N),z=P.multiply(M),j=z.toRawBytes();return{head:N,prefix:O,scalar:M,point:z,pointBytes:j}}function F(m){return E(m).pointBytes}function _(m=new Uint8Array,...p){let S=de(...p);return w(i(T(S,it("context",m),!!o)))}function U(m,p,S={}){m=it("message",m),o&&(m=o(m));let{prefix:N,scalar:O,pointBytes:M}=E(p),z=_(S.context,N,m),j=P.multiply(z).toRawBytes(),q=_(S.context,j,M,m),X=R(z+q*O);Ut("signature.s",X,Gt,n);let tt=de(j,Fe(X,r.BYTES));return it("result",tt,r.BYTES*2)}let K=gd;function A(m,p,S,N=K){let{context:O,zip215:M}=N,z=r.BYTES;m=it("signature",m,2*z),p=it("message",p),S=it("publicKey",S,z),M!==void 0&&Ht("zip215",M),o&&(p=o(p));let j=Ae(m.slice(z,2*z)),q,X,tt;try{q=x.fromHex(S,M),X=x.fromHex(m.slice(0,z),M),tt=P.multiplyUnsafe(j)}catch{return!1}if(!M&&q.isSmallOrder())return!1;let ft=_(O,X.toRawBytes(),q.toRawBytes(),p);return X.add(q.multiplyUnsafe(ft)).subtract(tt).clearCofactor().equals(x.ZERO)}return P._setWindowSize(8),{CURVE:t,getPublicKey:F,sign:U,verify:A,ExtendedPoint:x,utils:{getExtendedPublicKey:E,randomPrivateKey:()=>s(r.BYTES),precompute(m=8,p=x.BASE){return p._setWindowSize(m),p.multiply(BigInt(3)),p}}}}var Yo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),wa=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),lm=BigInt(0),xd=BigInt(1),ba=BigInt(2),dm=BigInt(3),wd=BigInt(5),bd=BigInt(8);function Ed(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),i=Yo,a=e*e%i*e%i,c=nt(a,ba,i)*a%i,l=nt(c,xd,i)*e%i,u=nt(l,wd,i)*l%i,f=nt(u,t,i)*u%i,d=nt(f,r,i)*f%i,b=nt(d,n,i)*d%i,T=nt(b,o,i)*b%i,y=nt(T,o,i)*b%i,h=nt(y,t,i)*u%i;return{pow_p_5_8:nt(h,ba,i)*e%i,b2:a}}function Sd(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function vd(e,t){let r=Yo,n=J(t*t*t,r),o=J(n*n*t,r),i=Ed(e*o).pow_p_5_8,s=J(e*n*i,r),a=J(t*s*s,r),c=s,l=J(s*wa,r),u=a===e,f=a===J(-e,r),d=a===J(-e*wa,r);return u&&(s=c),(f||d)&&(s=l),da(s,r)&&(s=J(-s,r)),{isValid:u||f,value:s}}var Ad=Te(Yo,void 0,!0),Id={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ad,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:bd,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:aa,randomBytes:fn,adjustScalarBytes:Sd,uvRatio:vd},Ea=xa(Id);var bn=32;function Sa(e,t,r){return Ea.verify(t,r instanceof Uint8Array?r:r.subarray(),e)}var En=class{type="Ed25519";raw;constructor(t){this.raw=Xo(t,bn)}toMultihash(){return $t.digest(Sn(this))}toCID(){return W.createV1(114,this.toMultihash())}toString(){return et.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ot(this.raw,t.raw)}verify(t,r){return Sa(this.raw,r,t)}};function Jo(e){return e=Xo(e,bn),new En(e)}function Xo(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new xt(`Key must be a Uint8Array of length ${t}, got ${e.length}`);return e}function he(e=0){return new Uint8Array(e)}function Pt(e=0){return new Uint8Array(e)}var Bd=Math.pow(2,7),Cd=Math.pow(2,14),Ud=Math.pow(2,21),Qo=Math.pow(2,28),ti=Math.pow(2,35),ei=Math.pow(2,42),ri=Math.pow(2,49),Y=128,wt=127;function Rt(e){if(e<Bd)return 1;if(e<Cd)return 2;if(e<Ud)return 3;if(e<Qo)return 4;if(e<ti)return 5;if(e<ei)return 6;if(e<ri)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function ni(e,t,r=0){switch(Rt(e)){case 8:t[r++]=e&255|Y,e/=128;case 7:t[r++]=e&255|Y,e/=128;case 6:t[r++]=e&255|Y,e/=128;case 5:t[r++]=e&255|Y,e/=128;case 4:t[r++]=e&255|Y,e>>>=7;case 3:t[r++]=e&255|Y,e>>>=7;case 2:t[r++]=e&255|Y,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function Nd(e,t,r=0){switch(Rt(e)){case 8:t.set(r++,e&255|Y),e/=128;case 7:t.set(r++,e&255|Y),e/=128;case 6:t.set(r++,e&255|Y),e/=128;case 5:t.set(r++,e&255|Y),e/=128;case 4:t.set(r++,e&255|Y),e>>>=7;case 3:t.set(r++,e&255|Y),e>>>=7;case 2:t.set(r++,e&255|Y),e>>>=7;case 1:{t.set(r++,e&255),e>>>=7;break}default:throw new Error("unreachable")}return t}function oi(e,t){let r=e[t],n=0;if(n+=r&wt,r<Y||(r=e[t+1],n+=(r&wt)<<7,r<Y)||(r=e[t+2],n+=(r&wt)<<14,r<Y)||(r=e[t+3],n+=(r&wt)<<21,r<Y)||(r=e[t+4],n+=(r&wt)*Qo,r<Y)||(r=e[t+5],n+=(r&wt)*ti,r<Y)||(r=e[t+6],n+=(r&wt)*ei,r<Y)||(r=e[t+7],n+=(r&wt)*ri,r<Y))return n;throw new RangeError("Could not decode varint")}function Pd(e,t){let r=e.get(t),n=0;if(n+=r&wt,r<Y||(r=e.get(t+1),n+=(r&wt)<<7,r<Y)||(r=e.get(t+2),n+=(r&wt)<<14,r<Y)||(r=e.get(t+3),n+=(r&wt)<<21,r<Y)||(r=e.get(t+4),n+=(r&wt)*Qo,r<Y)||(r=e.get(t+5),n+=(r&wt)*ti,r<Y)||(r=e.get(t+6),n+=(r&wt)*ei,r<Y)||(r=e.get(t+7),n+=(r&wt)*ri,r<Y))return n;throw new RangeError("Could not decode varint")}function sr(e,t,r=0){return t==null&&(t=Pt(Rt(e))),t instanceof Uint8Array?ni(e,t,r):Nd(e,t,r)}function Ve(e,t=0){return e instanceof Uint8Array?oi(e,t):Pd(e,t)}var ii=new Float32Array([-0]),Be=new Uint8Array(ii.buffer);function Ia(e,t,r){ii[0]=e,t[r]=Be[0],t[r+1]=Be[1],t[r+2]=Be[2],t[r+3]=Be[3]}function Ta(e,t){return Be[0]=e[t],Be[1]=e[t+1],Be[2]=e[t+2],Be[3]=e[t+3],ii[0]}var si=new Float64Array([-0]),bt=new Uint8Array(si.buffer);function Ba(e,t,r){si[0]=e,t[r]=bt[0],t[r+1]=bt[1],t[r+2]=bt[2],t[r+3]=bt[3],t[r+4]=bt[4],t[r+5]=bt[5],t[r+6]=bt[6],t[r+7]=bt[7]}function Ca(e,t){return bt[0]=e[t],bt[1]=e[t+1],bt[2]=e[t+2],bt[3]=e[t+3],bt[4]=e[t+4],bt[5]=e[t+5],bt[6]=e[t+6],bt[7]=e[t+7],si[0]}var Rd=BigInt(Number.MAX_SAFE_INTEGER),_d=BigInt(Number.MIN_SAFE_INTEGER),_t=class e{lo;hi;constructor(t,r){this.lo=t|0,this.hi=r|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return Ke;if(t<Rd&&t>_d)return this.fromNumber(Number(t));let r=t<0n;r&&(t=-t);let n=t>>32n,o=t-(n<<32n);return r&&(n=~n|0n,o=~o|0n,++o>Ua&&(o=0n,++n>Ua&&(n=0n))),new e(Number(o),Number(n))}static fromNumber(t){if(t===0)return Ke;let r=t<0;r&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return r&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new e(n,o)}static from(t){return typeof t=="number"?e.fromNumber(t):typeof t=="bigint"?e.fromBigInt(t):typeof t=="string"?e.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new e(t.low>>>0,t.high>>>0):Ke}},Ke=new _t(0,0);Ke.toBigInt=function(){return 0n};Ke.zzEncode=Ke.zzDecode=function(){return this};Ke.length=function(){return 1};var Ua=4294967296n;function Na(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function Pa(e,t,r){if(r-t<1)return"";let o,i=[],s=0,a;for(;t<r;)a=e[t++],a<128?i[s++]=a:a>191&&a<224?i[s++]=(a&31)<<6|e[t++]&63:a>239&&a<365?(a=((a&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,i[s++]=55296+(a>>10),i[s++]=56320+(a&1023)):i[s++]=(a&15)<<12|(e[t++]&63)<<6|e[t++]&63,s>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o!=null?(s>0&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))}function ai(e,t,r){let n=r,o,i;for(let s=0;s<e.length;++s)o=e.charCodeAt(s),o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&((i=e.charCodeAt(s+1))&64512)===56320?(o=65536+((o&1023)<<10)+(i&1023),++s,t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128);return r-n}function jt(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function vn(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}var ci=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,jt(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw jt(this,4);return vn(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw jt(this,4);return vn(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw jt(this,4);let t=Ta(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw jt(this,4);let t=Ca(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw jt(this,t);return this.pos+=t,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let t=this.bytes();return Pa(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw jt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw jt(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new _t(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw jt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,t}if(this.len-this.pos>4){for(;r<5;++r)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;r<5;++r){if(this.pos>=this.len)throw jt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw jt(this,8);let t=vn(this.buf,this.pos+=4),r=vn(this.buf,this.pos+=4);return new _t(t,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=oi(this.buf,this.pos);return this.pos+=Rt(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function ui(e){return new ci(e instanceof Uint8Array?e:e.subarray())}function ar(e,t,r){let n=ui(e);return t.decode(n,void 0,r)}var fi={};At(fi,{base10:()=>Ld});var Ld=xe({prefix:"9",name:"base10",alphabet:"0123456789"});var li={};At(li,{base16:()=>kd,base16upper:()=>Dd});var kd=st({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Dd=st({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var di={};At(di,{base2:()=>Fd});var Fd=st({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var hi={};At(hi,{base256emoji:()=>qd});var _a=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Od=_a.reduce((e,t,r)=>(e[r]=t,e),[]),Md=_a.reduce((e,t,r)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function Vd(e){return e.reduce((t,r)=>(t+=Od[r],t),"")}function Kd(e){let t=[];for(let r of e){let n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);let o=Md[n];if(o==null)throw new Error(`Non-base256emoji character: ${r}`);t.push(o)}return new Uint8Array(t)}var qd=Ye({prefix:"\u{1F680}",name:"base256emoji",encode:Vd,decode:Kd});var pi={};At(pi,{base8:()=>$d});var $d=st({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var mi={};At(mi,{identity:()=>zd});var zd=Ye({prefix:"\0",name:"identity",encode:e=>Ms(e),decode:e=>Os(e)});var jm=new TextEncoder,Zm=new TextDecoder;var xi={};At(xi,{sha256:()=>Rr,sha512:()=>jd});function yi({name:e,code:t,encode:r}){return new gi(e,t,r)}var gi=class{name;code;encode;constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?qt(this.code,r):r.then(n=>qt(this.code,n))}else throw Error("Unknown type, must be binary type")}};function ka(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}var Rr=yi({name:"sha2-256",code:18,encode:ka("SHA-256")}),jd=yi({name:"sha2-512",code:19,encode:ka("SHA-512")});var _r={...mi,...di,...pi,...fi,...li,...Io,...No,...To,...Co,...hi},sg={...xi,..._o};function Fa(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Da=Fa("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),wi=Fa("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=Pt(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Zd={utf8:Da,"utf-8":Da,hex:_r.base16,latin1:wi,ascii:wi,binary:wi,..._r},An=Zd;function H(e,t="utf8"){let r=An[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function bi(e){let t=e??8192,r=t>>>1,n,o=t;return function(s){if(s<1||s>r)return Pt(s);o+s>t&&(n=Pt(t),o=0);let a=n.subarray(o,o+=s);return(o&7)!==0&&(o=(o|7)+1),a}}var qe=class{fn;len;next;val;constructor(t,r,n){this.fn=t,this.len=r,this.next=void 0,this.val=n}};function Ei(){}var vi=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},Wd=bi();function Yd(e){return globalThis.Buffer!=null?Pt(e):Wd(e)}var kr=class{len;head;tail;states;constructor(){this.len=0,this.head=new qe(Ei,0,0),this.tail=this.head,this.states=null}_push(t,r,n){return this.tail=this.tail.next=new qe(t,r,n),this.len+=r,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Ai((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(In,10,_t.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let r=_t.fromBigInt(t);return this._push(In,r.length(),r)}uint64Number(t){return this._push(ni,Rt(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let r=_t.fromBigInt(t).zzEncode();return this._push(In,r.length(),r)}sint64Number(t){let r=_t.fromNumber(t).zzEncode();return this._push(In,r.length(),r)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(Si,1,t?1:0)}fixed32(t){return this._push(Lr,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let r=_t.fromBigInt(t);return this._push(Lr,4,r.lo)._push(Lr,4,r.hi)}fixed64Number(t){let r=_t.fromNumber(t);return this._push(Lr,4,r.lo)._push(Lr,4,r.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(Ia,4,t)}double(t){return this._push(Ba,8,t)}bytes(t){let r=t.length>>>0;return r===0?this._push(Si,1,0):this.uint32(r)._push(Jd,r,t)}string(t){let r=Na(t);return r!==0?this.uint32(r)._push(ai,r,t):this._push(Si,1,0)}fork(){return this.states=new vi(this),this.head=this.tail=new qe(Ei,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new qe(Ei,0,0),this.len=0),this}ldelim(){let t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=r,this.len+=n),this}finish(){let t=this.head.next,r=Yd(this.len),n=0;for(;t!=null;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r}};function Si(e,t,r){t[r]=e&255}function Xd(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}var Ai=class extends qe{next;constructor(t,r){super(Xd,t,r),this.next=void 0}};function In(e,t,r){for(;e.hi!==0;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}function Lr(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Jd(e,t,r){t.set(e,r)}globalThis.Buffer!=null&&(kr.prototype.bytes=function(e){let t=e.length>>>0;return this.uint32(t),t>0&&this._push(Qd,t,e),this},kr.prototype.string=function(e){let t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(th,t,e),this});function Qd(e,t,r){t.set(e,r)}function th(e,t,r){e.length<40?ai(e,t,r):t.utf8Write!=null?t.utf8Write(e,r):t.set(H(e),r)}function Ii(){return new kr}function cr(e,t){let r=Ii();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var ur;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(ur||(ur={}));function Tn(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Dr(e){function t(o){if(e[o.toString()]==null)throw new Error("Invalid enum value");return e[o]}let r=function(i,s){let a=t(i);s.int32(a)},n=function(i){let s=i.int32();return t(s)};return Tn("enum",ur.VARINT,r,n)}function fr(e,t){return Tn("message",ur.LENGTH_DELIMITED,e,t)}var ut;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.secp256k1="secp256k1"})(ut||(ut={}));var Ti;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.secp256k1=2]="secp256k1"})(Ti||(Ti={}));(function(e){e.codec=()=>Dr(Ti)})(ut||(ut={}));var ne;(function(e){let t;e.codec=()=>(t==null&&(t=fr((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:{i.Type=ut.codec().decode(r);break}case 2:{i.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return i})),t),e.encode=r=>cr(r,e.codec()),e.decode=(r,n)=>ar(r,e.codec(),n)})(ne||(ne={}));var Bi;(function(e){let t;e.codec=()=>(t==null&&(t=fr((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:{i.Type=ut.codec().decode(r);break}case 2:{i.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return i})),t),e.encode=r=>cr(r,e.codec()),e.decode=(r,n)=>ar(r,e.codec(),n)})(Bi||(Bi={}));var Mr={};At(Mr,{MAX_RSA_KEY_SIZE:()=>Ri,generateRSAKeyPair:()=>Ja,jwkToJWKKeyPair:()=>Qa,jwkToPkcs1:()=>dh,jwkToPkix:()=>Li,jwkToRSAPrivateKey:()=>Xa,pkcs1ToJwk:()=>Za,pkcs1ToRSAPrivateKey:()=>Ya,pkixToJwk:()=>Wa,pkixToRSAPublicKey:()=>ki});var eh=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ce=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ue=new Uint32Array(64),Ci=class extends or{constructor(){super(64,32,8,!1),this.A=Ce[0]|0,this.B=Ce[1]|0,this.C=Ce[2]|0,this.D=Ce[3]|0,this.E=Ce[4]|0,this.F=Ce[5]|0,this.G=Ce[6]|0,this.H=Ce[7]|0}get(){let{A:t,B:r,C:n,D:o,E:i,F:s,G:a,H:c}=this;return[t,r,n,o,i,s,a,c]}set(t,r,n,o,i,s,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,r){for(let f=0;f<16;f++,r+=4)Ue[f]=t.getUint32(r,!1);for(let f=16;f<64;f++){let d=Ue[f-15],b=Ue[f-2],T=zt(d,7)^zt(d,18)^d>>>3,y=zt(b,17)^zt(b,19)^b>>>10;Ue[f]=y+Ue[f-7]+T+Ue[f-16]|0}let{A:n,B:o,C:i,D:s,E:a,F:c,G:l,H:u}=this;for(let f=0;f<64;f++){let d=zt(a,6)^zt(a,11)^zt(a,25),b=u+d+oa(a,c,l)+eh[f]+Ue[f]|0,y=(zt(n,2)^zt(n,13)^zt(n,22))+ia(n,o,i)|0;u=l,l=c,c=a,a=s+b|0,s=i,i=o,o=n,n=b+y|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,o,i,s,a,c,l,u)}roundClean(){Ue.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var lr=un(()=>new Ci);function G(e,t="utf8"){let r=An[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}function Et(e,t){t==null&&(t=e.reduce((o,i)=>o+i.length,0));let r=Pt(t),n=0;for(let o of e)r.set(o,n),n+=o.length;return r}var Va=Symbol.for("@achingbrain/uint8arraylist");function Ma(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let o=r+n.byteLength;if(t<o)return{buf:n,index:t-r};r=o}throw new RangeError("index is out of bounds")}function dr(e){return!!e?.[Va]}var Zt=class e{bufs;length;[Va]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(dr(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(dr(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=Ma(this.bufs,t);return r.buf[r.index]}set(t,r){let n=Ma(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(dr(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:o}=this._subList(t,r);return Et(n,o)}subarray(t,r){let{bufs:n,length:o}=this._subList(t,r);return n.length===1?n[0]:Et(n,o)}sublist(t,r){let{bufs:n,length:o}=this._subList(t,r),i=new e;return i.length=o,i.bufs=[...n],i}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let i=0;i<this.bufs.length;i++){let s=this.bufs[i],a=o,c=a+s.byteLength;if(o=c,t>=c)continue;let l=t>=a&&t<c,u=r>a&&r<=c;if(l&&u){if(t===a&&r===c){n.push(s);break}let f=t-a;n.push(s.subarray(f,f+(r-t)));break}if(l){if(t===0){n.push(s);continue}n.push(s.subarray(t-a));continue}if(u){if(r===c){n.push(s);break}n.push(s.subarray(0,r-a));break}n.push(s)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!dr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let i=256,s=new Int32Array(i);for(let f=0;f<i;f++)s[f]=-1;for(let f=0;f<o;f++)s[n[f]]=f;let a=s,c=this.byteLength-n.byteLength,l=n.byteLength-1,u;for(let f=r;f<=c;f+=u){u=0;for(let d=l;d>=0;d--){let b=this.get(f+d);if(n[d]!==b){u=Math.max(1,d-a[b]);break}}if(u===0)return f}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=Pt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let o=he(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,r,n),this.write(o,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let o=he(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,r,n),this.write(o,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let o=he(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,r,n),this.write(o,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=Pt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let o=he(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,r,n),this.write(o,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let o=he(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,r,n),this.write(o,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let o=he(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,r,n),this.write(o,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let o=he(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,r,n),this.write(o,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let o=he(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,r,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!ot(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((o,i)=>o+i.byteLength,0)),n.length=r,n}};var rh=parseInt("11111",2),Ni=parseInt("10000000",2),nh=parseInt("01111111",2),Ka={2:oh,3:ah,5:sh,6:ih,16:Ui,22:Ui,48:Ui};function Fr(e,t={offset:0}){let r=e[t.offset]&rh;if(t.offset++,Ka[r]!=null)return Ka[r](e,t);throw new Error("No decoder for tag "+r)}function Bn(e,t){let r=0;if((e[t.offset]&Ni)===Ni){let n=e[t.offset]&nh,o="0x";t.offset++;for(let i=0;i<n;i++,t.offset++)o+=e[t.offset].toString(16).padStart(2,"0");r=parseInt(o,16)}else r=e[t.offset],t.offset++;return r}function Ui(e,t){Bn(e,t);let r=[];for(;!(t.offset>=e.byteLength);){let n=Fr(e,t);if(n===null)break;r.push(n)}return r}function oh(e,t){let r=Bn(e,t),n=t.offset,o=t.offset+r,i=[];for(let s=n;s<o;s++)s===n&&e[s]===0||i.push(e[s]);return t.offset+=r,Uint8Array.from(i)}function ih(e,t){let r=Bn(e,t);return t.offset+=r,["oid-unimplemented"]}function sh(e,t){return t.offset++,null}function ah(e,t){let r=Bn(e,t),n=e[t.offset];t.offset++;let o=e.subarray(t.offset,t.offset+r);if(t.offset+=r,n!==0)throw new Error("Unused bits in bit string is unimplemented");return Fr(o,{offset:0})}function ch(e){let t=e.toString(16);t.length%2===1&&(t="0"+t);let r=new Zt;for(let n=0;n<t.length;n+=2)r.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return r}function Pi(e){if(e.byteLength<128)return Uint8Array.from([e.byteLength]);let t=ch(e.byteLength);return new Zt(Uint8Array.from([t.byteLength|Ni]),t)}function Ot(e){let t=new Zt,r=parseInt("10000000",2);return(e.subarray()[0]&r)===r&&t.append(Uint8Array.from([0])),t.append(e),new Zt(Uint8Array.from([2]),Pi(t),t)}function qa(e){let t=Uint8Array.from([0]),r=new Zt(t,e);return new Zt(Uint8Array.from([3]),Pi(r),r)}function Cn(e){let t=new Zt;for(let r of e)t.append(r);return new Zt(Uint8Array.from([48]),Pi(t),t)}var Or=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},Un=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var $a={get(e=globalThis){let t=e.crypto;if(t?.subtle==null)throw new Un("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var Ne=$a;async function za(e){let t=await Ne.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await uh(t);return{privateKey:r[0],publicKey:r[1]}}async function Ha(e,t){let r=await Ne.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Ne.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function Ga(e,t,r){let n=await Ne.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Ne.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r instanceof Uint8Array?r:r.subarray())}async function uh(e){if(e.privateKey==null||e.publicKey==null)throw new xt("Private and public key are required");return Promise.all([Ne.get().subtle.exportKey("jwk",e.privateKey),Ne.get().subtle.exportKey("jwk",e.publicKey)])}function ja(e){if(e.kty!=="RSA")throw new xt("invalid key type");if(e.n==null)throw new xt("invalid key modulus");return H(e.n,"base64url").length*8}var hr=class{type="RSA";_key;_raw;_multihash;constructor(t,r){this._key=t,this._multihash=r}get raw(){return this._raw==null&&(this._raw=Mr.jwkToPkix(this._key)),this._raw}toMultihash(){return this._multihash}toCID(){return W.createV1(114,this._multihash)}toString(){return et.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ot(this.raw,t.raw)}verify(t,r){return Ga(this._key,r,t)}},Vr=class{type="RSA";_key;_raw;publicKey;constructor(t,r){this._key=t,this.publicKey=r}get raw(){return this._raw==null&&(this._raw=Mr.jwkToPkcs1(this._key)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ot(this.raw,t.raw)}sign(t){return Ha(this._key,t)}};var Ri=8192,_i=18,fh=1062,lh=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function Za(e){let t=Fr(e);return{n:G(t[1],"base64url"),e:G(t[2],"base64url"),d:G(t[3],"base64url"),p:G(t[4],"base64url"),q:G(t[5],"base64url"),dp:G(t[6],"base64url"),dq:G(t[7],"base64url"),qi:G(t[8],"base64url"),kty:"RSA"}}function dh(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new xt("JWK was missing components");return Cn([Ot(Uint8Array.from([0])),Ot(H(e.n,"base64url")),Ot(H(e.e,"base64url")),Ot(H(e.d,"base64url")),Ot(H(e.p,"base64url")),Ot(H(e.q,"base64url")),Ot(H(e.dp,"base64url")),Ot(H(e.dq,"base64url")),Ot(H(e.qi,"base64url"))]).subarray()}function Wa(e){let t=Fr(e,{offset:0});return{kty:"RSA",n:G(t[1][0],"base64url"),e:G(t[1][1],"base64url")}}function Li(e){if(e.n==null||e.e==null)throw new xt("JWK was missing components");return Cn([lh,qa(Cn([Ot(H(e.n,"base64url")),Ot(H(e.e,"base64url"))]))]).subarray()}function Ya(e){let t=Za(e);return Xa(t)}function ki(e,t){if(e.byteLength>=fh)throw new je("Key size is too large");let r=Wa(e);if(t==null){let n=lr(ne.encode({Type:ut.RSA,Data:e}));t=qt(_i,n)}return new hr(r,t)}function Xa(e){if(ja(e)>Ri)throw new xt("Key size is too large");let t=Qa(e),r=lr(ne.encode({Type:ut.RSA,Data:Li(t.publicKey)})),n=qt(_i,r);return new Vr(t.privateKey,new hr(t.publicKey,n))}async function Ja(e){if(e>Ri)throw new xt("Key size is too large");let t=await za(e),r=lr(ne.encode({Type:ut.RSA,Data:Li(t.publicKey)})),n=qt(_i,r);return new Vr(t.privateKey,new hr(t.publicKey,n))}function Qa(e){if(e==null)throw new xt("Missing key parameter");return{privateKey:e,publicKey:{kty:e.kty,n:e.n,e:e.e}}}var Nn=class extends nr{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,ea(t);let n=Cr(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,i=new Uint8Array(o);i.set(n.length>o?t.create().update(n).digest():n);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(t){return rr(this),this.iHash.update(t),this}digestInto(t){rr(this),er(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Di=(e,t,r)=>new Nn(e,t).update(r).digest();Di.create=(e,t)=>new Nn(e,t);function tc(e){e.lowS!==void 0&&Ht("lowS",e.lowS),e.prehash!==void 0&&Ht("prehash",e.prehash)}function hh(e){let t=Pr(e);re(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:o}=t;if(r){if(!n.eql(o,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:ph,hexToBytes:mh}=pn,Fi=class extends Error{constructor(t=""){super(t)}},pe={Err:Fi,_tlv:{encode:(e,t)=>{let{Err:r}=pe;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=ke(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let i=n>127?ke(o.length/2|128):"";return ke(e)+i+o+t},decode(e,t){let{Err:r}=pe,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],i=!!(o&128),s=0;if(!i)s=o;else{let c=o&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");let l=t.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let u of l)s=s<<8|u;if(n+=c,s<128)throw new r("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+s)}}},_int:{encode(e){let{Err:t}=pe;if(e<me)throw new t("integer: negative integers are not allowed");let r=ke(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=pe;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return ph(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=pe,o=typeof e=="string"?mh(e):e;ir(o);let{v:i,l:s}=n.decode(48,o);if(s.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=pe,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),i=n+o;return t.encode(48,i)}},me=BigInt(0),dt=BigInt(1),Cy=BigInt(2),ec=BigInt(3),Uy=BigInt(4);function gh(e){let t=hh(e),{Fp:r}=t,n=Te(t.n,t.nBitLength),o=t.toBytes||((y,h,v)=>{let C=h.toAffine();return de(Uint8Array.from([4]),r.toBytes(C.x),r.toBytes(C.y))}),i=t.fromBytes||(y=>{let h=y.subarray(1),v=r.fromBytes(h.subarray(0,r.BYTES)),C=r.fromBytes(h.subarray(r.BYTES,2*r.BYTES));return{x:v,y:C}});function s(y){let{a:h,b:v}=t,C=r.sqr(y),x=r.mul(C,y);return r.add(r.add(x,r.mul(y,h)),v)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function a(y){return Ur(y,dt,t.n)}function c(y){let{allowedPrivateKeyLengths:h,nByteLength:v,wrapPrivateKey:C,n:x}=t;if(h&&typeof y!="bigint"){if(ve(y)&&(y=fe(y)),typeof y!="string"||!h.includes(y.length))throw new Error("invalid private key");y=y.padStart(v*2,"0")}let P;try{P=typeof y=="bigint"?y:le(it("private key",y,v))}catch{throw new Error("invalid private key, expected hex or "+v+" bytes, got "+typeof y)}return C&&(P=J(P,x)),Ut("private key",P,dt,x),P}function l(y){if(!(y instanceof d))throw new Error("ProjectivePoint expected")}let u=Oe((y,h)=>{let{px:v,py:C,pz:x}=y;if(r.eql(x,r.ONE))return{x:v,y:C};let P=y.is0();h==null&&(h=P?r.ONE:r.inv(x));let D=r.mul(v,h),k=r.mul(C,h),R=r.mul(x,h);if(P)return{x:r.ZERO,y:r.ZERO};if(!r.eql(R,r.ONE))throw new Error("invZ was invalid");return{x:D,y:k}}),f=Oe(y=>{if(y.is0()){if(t.allowInfinityPoint&&!r.is0(y.py))return;throw new Error("bad point: ZERO")}let{x:h,y:v}=y.toAffine();if(!r.isValid(h)||!r.isValid(v))throw new Error("bad point: x or y not FE");let C=r.sqr(v),x=s(h);if(!r.eql(C,x))throw new Error("bad point: equation left != right");if(!y.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(h,v,C){if(this.px=h,this.py=v,this.pz=C,h==null||!r.isValid(h))throw new Error("x required");if(v==null||!r.isValid(v))throw new Error("y required");if(C==null||!r.isValid(C))throw new Error("z required");Object.freeze(this)}static fromAffine(h){let{x:v,y:C}=h||{};if(!h||!r.isValid(v)||!r.isValid(C))throw new Error("invalid affine point");if(h instanceof d)throw new Error("projective point not allowed");let x=P=>r.eql(P,r.ZERO);return x(v)&&x(C)?d.ZERO:new d(v,C,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){let v=r.invertBatch(h.map(C=>C.pz));return h.map((C,x)=>C.toAffine(v[x])).map(d.fromAffine)}static fromHex(h){let v=d.fromAffine(i(it("pointHex",h)));return v.assertValidity(),v}static fromPrivateKey(h){return d.BASE.multiply(c(h))}static msm(h,v){return xn(d,n,h,v)}_setWindowSize(h){T.setWindowSize(this,h)}assertValidity(){f(this)}hasEvenY(){let{y:h}=this.toAffine();if(r.isOdd)return!r.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){l(h);let{px:v,py:C,pz:x}=this,{px:P,py:D,pz:k}=h,R=r.eql(r.mul(v,k),r.mul(P,x)),w=r.eql(r.mul(C,k),r.mul(D,x));return R&&w}negate(){return new d(this.px,r.neg(this.py),this.pz)}double(){let{a:h,b:v}=t,C=r.mul(v,ec),{px:x,py:P,pz:D}=this,k=r.ZERO,R=r.ZERO,w=r.ZERO,E=r.mul(x,x),F=r.mul(P,P),_=r.mul(D,D),U=r.mul(x,P);return U=r.add(U,U),w=r.mul(x,D),w=r.add(w,w),k=r.mul(h,w),R=r.mul(C,_),R=r.add(k,R),k=r.sub(F,R),R=r.add(F,R),R=r.mul(k,R),k=r.mul(U,k),w=r.mul(C,w),_=r.mul(h,_),U=r.sub(E,_),U=r.mul(h,U),U=r.add(U,w),w=r.add(E,E),E=r.add(w,E),E=r.add(E,_),E=r.mul(E,U),R=r.add(R,E),_=r.mul(P,D),_=r.add(_,_),E=r.mul(_,U),k=r.sub(k,E),w=r.mul(_,F),w=r.add(w,w),w=r.add(w,w),new d(k,R,w)}add(h){l(h);let{px:v,py:C,pz:x}=this,{px:P,py:D,pz:k}=h,R=r.ZERO,w=r.ZERO,E=r.ZERO,F=t.a,_=r.mul(t.b,ec),U=r.mul(v,P),K=r.mul(C,D),A=r.mul(x,k),I=r.add(v,C),m=r.add(P,D);I=r.mul(I,m),m=r.add(U,K),I=r.sub(I,m),m=r.add(v,x);let p=r.add(P,k);return m=r.mul(m,p),p=r.add(U,A),m=r.sub(m,p),p=r.add(C,x),R=r.add(D,k),p=r.mul(p,R),R=r.add(K,A),p=r.sub(p,R),E=r.mul(F,m),R=r.mul(_,A),E=r.add(R,E),R=r.sub(K,E),E=r.add(K,E),w=r.mul(R,E),K=r.add(U,U),K=r.add(K,U),A=r.mul(F,A),m=r.mul(_,m),K=r.add(K,A),A=r.sub(U,A),A=r.mul(F,A),m=r.add(m,A),U=r.mul(K,m),w=r.add(w,U),U=r.mul(p,m),R=r.mul(I,R),R=r.sub(R,U),U=r.mul(I,K),E=r.mul(p,E),E=r.add(E,U),new d(R,w,E)}subtract(h){return this.add(h.negate())}is0(){return this.equals(d.ZERO)}wNAF(h){return T.wNAFCached(this,h,d.normalizeZ)}multiplyUnsafe(h){let{endo:v,n:C}=t;Ut("scalar",h,me,C);let x=d.ZERO;if(h===me)return x;if(this.is0()||h===dt)return this;if(!v||T.hasPrecomputes(this))return T.wNAFCachedUnsafe(this,h,d.normalizeZ);let{k1neg:P,k1:D,k2neg:k,k2:R}=v.splitScalar(h),w=x,E=x,F=this;for(;D>me||R>me;)D&dt&&(w=w.add(F)),R&dt&&(E=E.add(F)),F=F.double(),D>>=dt,R>>=dt;return P&&(w=w.negate()),k&&(E=E.negate()),E=new d(r.mul(E.px,v.beta),E.py,E.pz),w.add(E)}multiply(h){let{endo:v,n:C}=t;Ut("scalar",h,dt,C);let x,P;if(v){let{k1neg:D,k1:k,k2neg:R,k2:w}=v.splitScalar(h),{p:E,f:F}=this.wNAF(k),{p:_,f:U}=this.wNAF(w);E=T.constTimeNegate(D,E),_=T.constTimeNegate(R,_),_=new d(r.mul(_.px,v.beta),_.py,_.pz),x=E.add(_),P=F.add(U)}else{let{p:D,f:k}=this.wNAF(h);x=D,P=k}return d.normalizeZ([x,P])[0]}multiplyAndAddUnsafe(h,v,C){let x=d.BASE,P=(k,R)=>R===me||R===dt||!k.equals(x)?k.multiplyUnsafe(R):k.multiply(R),D=P(this,v).add(P(h,C));return D.is0()?void 0:D}toAffine(h){return u(this,h)}isTorsionFree(){let{h,isTorsionFree:v}=t;if(h===dt)return!0;if(v)return v(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h,clearCofactor:v}=t;return h===dt?this:v?v(d,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return Ht("isCompressed",h),this.assertValidity(),o(d,this,h)}toHex(h=!0){return Ht("isCompressed",h),fe(this.toRawBytes(h))}}d.BASE=new d(t.Gx,t.Gy,r.ONE),d.ZERO=new d(r.ZERO,r.ONE,r.ZERO);let b=t.nBitLength,T=yn(d,t.endo?Math.ceil(b/2):b);return{CURVE:t,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:a}}function yh(e){let t=Pr(e);return re(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function rc(e){let t=yh(e),{Fp:r,n}=t,o=r.BYTES+1,i=2*r.BYTES+1;function s(A){return J(A,n)}function a(A){return mn(A,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:f}=gh({...t,toBytes(A,I,m){let p=I.toAffine(),S=r.toBytes(p.x),N=de;return Ht("isCompressed",m),m?N(Uint8Array.from([I.hasEvenY()?2:3]),S):N(Uint8Array.from([4]),S,r.toBytes(p.y))},fromBytes(A){let I=A.length,m=A[0],p=A.subarray(1);if(I===o&&(m===2||m===3)){let S=le(p);if(!Ur(S,dt,r.ORDER))throw new Error("Point is not on curve");let N=u(S),O;try{O=r.sqrt(N)}catch(j){let q=j instanceof Error?": "+j.message:"";throw new Error("Point is not on curve"+q)}let M=(O&dt)===dt;return(m&1)===1!==M&&(O=r.neg(O)),{x:S,y:O}}else if(I===i&&m===4){let S=r.fromBytes(p.subarray(0,r.BYTES)),N=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:S,y:N}}else{let S=o,N=i;throw new Error("invalid Point, expected length of "+S+", or uncompressed "+N+", got "+I)}}}),d=A=>fe(Ie(A,t.nByteLength));function b(A){let I=n>>dt;return A>I}function T(A){return b(A)?s(-A):A}let y=(A,I,m)=>le(A.slice(I,m));class h{constructor(I,m,p){this.r=I,this.s=m,this.recovery=p,this.assertValidity()}static fromCompact(I){let m=t.nByteLength;return I=it("compactSignature",I,m*2),new h(y(I,0,m),y(I,m,2*m))}static fromDER(I){let{r:m,s:p}=pe.toSig(it("DER",I));return new h(m,p)}assertValidity(){Ut("r",this.r,dt,n),Ut("s",this.s,dt,n)}addRecoveryBit(I){return new h(this.r,this.s,I)}recoverPublicKey(I){let{r:m,s:p,recovery:S}=this,N=k(it("msgHash",I));if(S==null||![0,1,2,3].includes(S))throw new Error("recovery id invalid");let O=S===2||S===3?m+t.n:m;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let M=(S&1)===0?"02":"03",z=c.fromHex(M+d(O)),j=a(O),q=s(-N*j),X=s(p*j),tt=c.BASE.multiplyAndAddUnsafe(z,q,X);if(!tt)throw new Error("point at infinify");return tt.assertValidity(),tt}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return De(this.toDERHex())}toDERHex(){return pe.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return De(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}let v={isValidPrivateKey(A){try{return l(A),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let A=Ho(t.n);return pa(t.randomBytes(A),t.n)},precompute(A=8,I=c.BASE){return I._setWindowSize(A),I.multiply(BigInt(3)),I}};function C(A,I=!0){return c.fromPrivateKey(A).toRawBytes(I)}function x(A){let I=ve(A),m=typeof A=="string",p=(I||m)&&A.length;return I?p===o||p===i:m?p===2*o||p===2*i:A instanceof c}function P(A,I,m=!0){if(x(A))throw new Error("first arg must be private key");if(!x(I))throw new Error("second arg must be public key");return c.fromHex(I).multiply(l(A)).toRawBytes(m)}let D=t.bits2int||function(A){if(A.length>8192)throw new Error("input is too large");let I=le(A),m=A.length*8-t.nBitLength;return m>0?I>>BigInt(m):I},k=t.bits2int_modN||function(A){return s(D(A))},R=Nr(t.nBitLength);function w(A){return Ut("num < 2^"+t.nBitLength,A,me,R),Ie(A,t.nByteLength)}function E(A,I,m=F){if(["recovered","canonical"].some(lt=>lt in m))throw new Error("sign() legacy options not supported");let{hash:p,randomBytes:S}=t,{lowS:N,prehash:O,extraEntropy:M}=m;N==null&&(N=!0),A=it("msgHash",A),tc(m),O&&(A=it("prehashed msgHash",p(A)));let z=k(A),j=l(I),q=[w(j),w(z)];if(M!=null&&M!==!1){let lt=M===!0?S(r.BYTES):M;q.push(it("extraEntropy",lt))}let X=de(...q),tt=z;function ft(lt){let mt=D(lt);if(!f(mt))return;let yt=a(mt),Tt=c.BASE.multiply(mt).toAffine(),vt=s(Tt.x);if(vt===me)return;let ee=s(yt*s(tt+vt*j));if(ee===me)return;let se=(Tt.x===vt?0:2)|Number(Tt.y&dt),Ar=ee;return N&&b(ee)&&(Ar=T(ee),se^=1),new h(vt,Ar,se)}return{seed:X,k2sig:ft}}let F={lowS:t.lowS,prehash:!1},_={lowS:t.lowS,prehash:!1};function U(A,I,m=F){let{seed:p,k2sig:S}=E(A,I,m),N=t;return Ko(N.hash.outputLen,N.nByteLength,N.hmac)(p,S)}c.BASE._setWindowSize(8);function K(A,I,m,p=_){let S=A;I=it("msgHash",I),m=it("publicKey",m);let{lowS:N,prehash:O,format:M}=p;if(tc(p),"strict"in p)throw new Error("options.strict was renamed to lowS");if(M!==void 0&&M!=="compact"&&M!=="der")throw new Error("format must be compact or der");let z=typeof S=="string"||ve(S),j=!z&&!M&&typeof S=="object"&&S!==null&&typeof S.r=="bigint"&&typeof S.s=="bigint";if(!z&&!j)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let q,X;try{if(j&&(q=new h(S.r,S.s)),z){try{M!=="compact"&&(q=h.fromDER(S))}catch(se){if(!(se instanceof pe.Err))throw se}!q&&M!=="der"&&(q=h.fromCompact(S))}X=c.fromHex(m)}catch{return!1}if(!q||N&&q.hasHighS())return!1;O&&(I=t.hash(I));let{r:tt,s:ft}=q,lt=k(I),mt=a(ft),yt=s(lt*mt),Tt=s(tt*mt),vt=c.BASE.multiplyAndAddUnsafe(X,yt,Tt)?.toAffine();return vt?s(vt.x)===tt:!1}return{CURVE:t,getPublicKey:C,getSharedSecret:P,sign:U,verify:K,ProjectivePoint:c,Signature:h,utils:v}}function xh(e){return{hash:e,hmac:(t,...r)=>Di(e,t,Lo(...r)),randomBytes:fn}}function nc(e,t){let r=n=>rc({...e,...xh(n)});return{...r(t),create:r}}var sc=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),oc=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),wh=BigInt(1),Oi=BigInt(2),ic=(e,t)=>(e+t/Oi)/t;function bh(e){let t=sc,r=BigInt(3),n=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,f=nt(u,r,t)*u%t,d=nt(f,r,t)*u%t,b=nt(d,Oi,t)*l%t,T=nt(b,o,t)*b%t,y=nt(T,i,t)*T%t,h=nt(y,a,t)*y%t,v=nt(h,c,t)*h%t,C=nt(v,a,t)*y%t,x=nt(C,r,t)*u%t,P=nt(x,s,t)*T%t,D=nt(P,n,t)*l%t,k=nt(D,Oi,t);if(!Mi.eql(Mi.sqr(k),e))throw new Error("Cannot find square root");return k}var Mi=Te(sc,void 0,void 0,{sqrt:bh}),$e=nc({a:BigInt(0),b:BigInt(7),Fp:Mi,n:oc,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=oc,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-wh*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,s=BigInt("0x100000000000000000000000000000000"),a=ic(i*e,t),c=ic(-n*e,t),l=J(e-a*r-c*o,t),u=J(-a*n-c*i,t),f=l>s,d=u>s;if(f&&(l=t-l),d&&(u=t-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:l,k2neg:d,k2:u}}}},lr),Oy=BigInt(0);var My=$e.ProjectivePoint;function ac(e){return e==null?!1:typeof e.then=="function"&&typeof e.catch=="function"&&typeof e.finally=="function"}function cc(e,t,r){let n=Rr.digest(r instanceof Uint8Array?r:r.subarray());if(ac(n))return n.then(({digest:o})=>$e.verify(t,o,e)).catch(o=>{throw new Or(String(o))});try{return $e.verify(t,n.digest,e)}catch(o){throw new Or(String(o))}}var Pn=class{type="secp256k1";raw;_key;constructor(t){this._key=fc(t),this.raw=uc(this._key)}toMultihash(){return $t.digest(Sn(this))}toCID(){return W.createV1(114,this.toMultihash())}toString(){return et.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ot(this.raw,t.raw)}verify(t,r){return cc(this._key,r,t)}};function Vi(e){return new Pn(e)}function uc(e){return $e.ProjectivePoint.fromHex(e).toRawBytes(!0)}function fc(e){try{return $e.ProjectivePoint.fromHex(e),e}catch(t){throw new je(String(t))}}function lc(e,t){let{Type:r,Data:n}=ne.decode(e),o=n??new Uint8Array;switch(r){case ut.RSA:return ki(o,t);case ut.Ed25519:return Jo(o);case ut.secp256k1:return Vi(o);default:throw new We}}function Rn(e){let{Type:t,Data:r}=ne.decode(e.digest),n=r??new Uint8Array;switch(t){case ut.Ed25519:return Jo(n);case ut.secp256k1:return Vi(n);default:throw new We}}function Sn(e){return ne.encode({Type:ut[e.type],Data:e.raw})}var dc=Symbol.for("nodejs.util.inspect.custom"),Eh=114,Kr=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[bo]=!0;toString(){return this.string==null&&(this.string=et.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return W.createV1(Eh,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return ot(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return ot(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[dc](){return`PeerId(${this.toString()})`}},_n=class extends Kr{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Ln=class extends Kr{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},kn=class extends Kr{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},Sh=2336,qr=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=$t.digest(H(this.url))}[dc](){return`PeerId(${this.url})`}[bo]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return W.createV1(Sh,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=G(t)),t.toString()===this.toString())}};var vh=114,hc=2336;function pc(e,t){let r;if(e.charAt(0)==="1"||e.charAt(0)==="Q")r=ce(et.decode(`z${e}`));else{if(e.startsWith("k51qzi5uqu5")||e.startsWith("kzwfwjn5ji4")||e.startsWith("k2k4r8")||e.startsWith("bafz"))return Ki(W.parse(e));if(t==null)throw new xt('Please pass a multibase decoder for strings that do not start with "1" or "Q"');r=ce(t.decode(e))}return mc(r)}function mc(e){if(Ih(e))return new _n({multihash:e});if(Ah(e))try{let t=Rn(e);if(t.type==="Ed25519")return new Ln({multihash:e,publicKey:t});if(t.type==="secp256k1")return new kn({multihash:e,publicKey:t})}catch{let r=G(e.digest);return new qr(new URL(r))}throw new Ze("Supplied PeerID Multihash is invalid")}function Ki(e){if(e?.multihash==null||e.version==null||e.version===1&&e.code!==vh&&e.code!==hc)throw new rn("Supplied PeerID CID is invalid");if(e.code===hc){let t=G(e.multihash.digest);return new qr(new URL(t))}return mc(e.multihash)}function Ah(e){return e.code===$t.code}function Ih(e){return e.code===Rr.code}var Dn=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){let r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,o){return this.readAtomically(()=>{let i=0,s=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",l=2**(8*o)-1;for(;;){let u=this.readAtomically(()=>{let f=this.readChar();if(f===void 0)return;let d=Number.parseInt(f,t);if(!Number.isNaN(d))return d});if(u===void 0)break;if(i*=t,i+=u,i>l||(s+=1,r!==void 0&&s>r))return}if(s!==0)return!n&&c&&s>1?void 0:i})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let r=0;r<t.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){let t=r=>{for(let n=0;n<r.length/2;n++){let o=n*2;if(n<r.length-3){let s=this.readSeparator(":",n,()=>this.readIPv4Addr());if(s!==void 0)return r[o]=s[0],r[o+1]=s[1],r[o+2]=s[2],r[o+3]=s[3],[o+4,!0]}let i=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(i===void 0)return[o,!1];r[o]=i>>8,r[o+1]=i&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,o]=t(r);if(n===16)return r;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let i=new Uint8Array(14),s=16-(n+2),[a]=t(i.subarray(0,s));return r.set(i.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var gc=45,Th=15,pr=new Dn;function qi(e){if(!(e.length>Th))return pr.new(e).parseWith(()=>pr.readIPv4Addr())}function $i(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>gc))return pr.new(e).parseWith(()=>pr.readIPv6Addr())}function Fn(e,t=!1){if(e.includes("%")&&(e=e.split("%")[0]),e.length>gc)return;let r=pr.new(e).parseWith(()=>pr.readIPAddr());if(r)return t&&r.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,r[0],r[1],r[2],r[3]]):r}var Wx=parseInt("0xFFFF",16),Yx=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function wc(e){return!!qi(e)}function bc(e){return!!$i(e)}function On(e){return!!Fn(e)}var Ec=wc,Ph=bc,zi=function(e){let t=0;if(e=e.toString().trim(),Ec(e)){let r=new Uint8Array(t+4);return e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255}),r}if(Ph(e)){let r=e.split(":",8),n;for(n=0;n<r.length;n++){let i=Ec(r[n]),s;i&&(s=zi(r[n]),r[n]=G(s.slice(0,2),"base16")),s!=null&&++n<8&&r.splice(n,0,G(s.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let i=[n,1];for(n=9-r.length;n>0;n--)i.push("0");r.splice.apply(r,i)}let o=new Uint8Array(t+16);for(n=0;n<r.length;n++){let i=parseInt(r[n],16);o[t++]=i>>8&255,o[t++]=i&255}return o}throw new Error("invalid ip address")},Sc=function(e,t=0,r){t=~~t,r=r??e.length-t;let n=new DataView(e.buffer);if(r===4){let o=[];for(let i=0;i<r;i++)o.push(e[t+i]);return o.join(".")}if(r===16){let o=[];for(let i=0;i<r;i+=2)o.push(n.getUint16(t+i).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var mr={},Hi={},_h=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,-1,"http-path"],[777,-1,"memory"]];_h.forEach(e=>{let t=Lh(...e);Hi[t.code]=t,mr[t.name]=t});function Lh(e,t,r,n,o){return{code:e,size:t,name:r,resolvable:!!n,path:!!o}}function Q(e){if(typeof e=="number"){if(Hi[e]!=null)return Hi[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(mr[e]!=null)return mr[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var _w=Q("ip4"),Lw=Q("ip6"),kw=Q("ipcidr");function Wi(e,t){switch(Q(e).code){case 4:case 41:return Dh(t);case 42:return Zi(t);case 43:return G(t,"base10");case 6:case 273:case 33:case 132:return Ic(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Zi(t);case 421:return Vh(t);case 444:return Ac(t);case 445:return Ac(t);case 466:return Mh(t);case 481:return globalThis.encodeURIComponent(Zi(t));default:return G(t,"base16")}}function Yi(e,t){switch(Q(e).code){case 4:return vc(t);case 41:return vc(t);case 42:return ji(t);case 43:return H(t,"base10");case 6:case 273:case 33:case 132:return Xi(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return ji(t);case 421:return Fh(t);case 444:return Kh(t);case 445:return qh(t);case 466:return Oh(t);case 481:return ji(globalThis.decodeURIComponent(t));default:return H(t,"base16")}}var Gi=Object.values(_r).map(e=>e.decoder),kh=function(){let e=Gi[0].or(Gi[1]);return Gi.slice(2).forEach(t=>e=e.or(t)),e}();function vc(e){if(!On(e))throw new Error("invalid ip address");return zi(e)}function Dh(e){let t=Sc(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!On(t))throw new Error("invalid ip address");return t}function Xi(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function Ic(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function ji(e){let t=H(e),r=Uint8Array.from(sr(t.length));return Et([r,t],r.length+t.length)}function Zi(e){let t=Ve(e);if(e=e.slice(Rt(t)),e.length!==t)throw new Error("inconsistent lengths");return G(e)}function Fh(e){let t;e[0]==="Q"||e[0]==="1"?t=ce(et.decode(`z${e}`)).bytes:t=W.parse(e).multihash.bytes;let r=Uint8Array.from(sr(t.length));return Et([r,t],r.length+t.length)}function Oh(e){let t=kh.decode(e),r=Uint8Array.from(sr(t.length));return Et([r,t],r.length+t.length)}function Mh(e){let t=Ve(e),r=e.slice(Rt(t));if(r.length!==t)throw new Error("inconsistent lengths");return"u"+G(r,"base64url")}function Vh(e){let t=Ve(e),r=e.slice(Rt(t));if(r.length!==t)throw new Error("inconsistent lengths");return G(r,"base58btc")}function Kh(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let r=Kt.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Xi(n);return Et([r,o],r.length+o.length)}function qh(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let r=Kt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Xi(n);return Et([r,o],r.length+o.length)}function Ac(e){let t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=G(t,"base32"),o=Ic(r);return`${n}:${o}`}function Tc(e){e=Ji(e);let t=[],r=[],n=null,o=e.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let i=0;i<o.length;i++){let s=o[i],a=Q(s);if(a.size===0){t.push([a.code]),r.push([a.code]);continue}if(i++,i>=o.length)throw new Mn("invalid address: "+e);if(a.path===!0){n=Ji(o.slice(i).join("/")),t.push([a.code,Yi(a.code,n)]),r.push([a.code,n]);break}let c=Yi(a.code,o[i]);t.push([a.code,c]),r.push([a.code,Wi(a.code,c)])}return{string:Bc(r),bytes:Vn(t),tuples:t,stringTuples:r,path:n}}function Qi(e){let t=[],r=[],n=null,o=0;for(;o<e.length;){let i=Ve(e,o),s=Rt(i),a=Q(i),c=$h(a,e.slice(o+s));if(c===0){t.push([i]),r.push([i]),o+=s;continue}let l=e.slice(o+s,o+s+c);if(o+=c+s,o>e.length)throw new Mn("Invalid address Uint8Array: "+G(e,"base16"));t.push([i,l]);let u=Wi(i,l);if(r.push([i,u]),a.path===!0){n=u;break}}return{bytes:Uint8Array.from(e),string:Bc(r),tuples:t,stringTuples:r,path:n}}function Bc(e){let t=[];return e.map(r=>{let n=Q(r[0]);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),Ji(t.join("/"))}function Vn(e){return Et(e.map(t=>{let r=Q(t[0]),n=Uint8Array.from(sr(r.code));return t.length>1&&t[1]!=null&&(n=Et([n,t[1]])),n}))}function $h(e,t){if(e.size>0)return e.size/8;if(e.size===0)return 0;{let r=Ve(t instanceof Uint8Array?t:Uint8Array.from(t));return r+Rt(r)}}function Ji(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}var Mn=class extends Error{static name="ParseError";name="ParseError";constructor(t){super(`Error parsing address: ${t}`)}};var zh=Symbol.for("nodejs.util.inspect.custom"),es=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Hh=[Q("dns").code,Q("dns4").code,Q("dns6").code,Q("dnsaddr").code],ts=class extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}},Kn=class e{bytes;#t;#r;#e;#a;[es]=!0;constructor(t){t==null&&(t="");let r;if(t instanceof Uint8Array)r=Qi(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);r=Tc(t)}else if(Uc(t))r=Qi(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#t=r.string,this.#r=r.tuples,this.#e=r.stringTuples,this.#a=r.path}toString(){return this.#t}toJSON(){return this.toString()}toOptions(){let t,r,n,o,i="",s=Q("tcp"),a=Q("udp"),c=Q("ip4"),l=Q("ip6"),u=Q("dns6"),f=Q("ip6zone");for(let[b,T]of this.stringTuples())b===f.code&&(i=`%${T??""}`),Hh.includes(b)&&(r=s.name==="tcp"?"tcp":"udp",o=443,n=`${T??""}${i}`,t=b===u.code?6:4),(b===s.code||b===a.code)&&(r=Q(b).name==="tcp"?"tcp":"udp",o=parseInt(T??"")),(b===c.code||b===l.code)&&(r=Q(b).name==="tcp"?"tcp":"udp",n=`${T??""}${i}`,t=b===l.code?6:4);if(t==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:o}}protos(){return this.#r.map(([t])=>Object.assign({},Q(t)))}protoCodes(){return this.#r.map(([t])=>t)}protoNames(){return this.#r.map(([t])=>Q(t).name)}tuples(){return this.#r.map(([t,r])=>r==null?[t]:[t,r])}stringTuples(){return this.#e.map(([t,r])=>r==null?[t]:[t,r])}encapsulate(t){return t=new e(t),new e(this.toString()+t.toString())}decapsulate(t){let r=t.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new e(n.slice(0,o))}decapsulateCode(t){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new e(Vn(r.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,o])=>{n===mr.p2p.code&&t.push([n,o]),n===mr["p2p-circuit"].code&&(t=[])});let r=t.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?G(et.decode(`z${n}`),"base58btc"):G(W.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#a}equals(t){return ot(this.bytes,t.bytes)}async resolve(t){let r=this.protos().find(i=>i.resolvable);if(r==null)return[this];let n=Cc.get(r.name);if(n==null)throw new ts(`no available resolver for ${r.name}`);return(await n(this,t)).map(i=>ze(i))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[zh](){return`Multiaddr(${this.#t})`}};var Cc=new Map;function Uc(e){return!!e?.[es]}function ze(e){return new Kn(e)}function $r(e){let t=new globalThis.AbortController;function r(){t.abort();for(let i of e)i?.removeEventListener!=null&&i.removeEventListener("abort",r)}for(let i of e){if(i?.aborted===!0){r();break}i?.addEventListener!=null&&i.addEventListener("abort",r)}function n(){for(let i of e)i?.removeEventListener!=null&&i.removeEventListener("abort",r)}let o=t.signal;return o.clear=n,o}async function*qn(e,t={}){let r=e.getReader();try{for(;;){let n=await r.read();if(n.done)return;yield n.value}}finally{t.preventCancel!==!0&&await r.cancel(),r.releaseLock()}}var Gh="/",jh=new TextEncoder().encode(Gh),lb=jh[0];var Bp=wo(ns(),1);var Wt=class extends Error{static name="SignatureVerificationError";constructor(t="Record signature verification failed"){super(t),this.name="SignatureVerificationError"}},$n=class extends Error{static name="RecordExpiredError";constructor(t="Record has expired"){super(t),this.name="RecordExpiredError"}},gr=class extends Error{static name="UnsupportedValidityError";constructor(t="The validity type is unsupported"){super(t),this.name="UnsupportedValidityError"}},zn=class extends Error{static name="RecordTooLargeError";constructor(t="The record is too large"){super(t),this.name="RecordTooLargeError"}},Hn=class extends Error{static name="InvalidValueError";constructor(t="Value must be a valid content path starting with /"){super(t),this.name="InvalidValueError"}},Gn=class extends Error{static name="InvalidRecordDataError";constructor(t="Invalid record data"){super(t),this.name="InvalidRecordDataError"}},zr=class extends Error{static name="InvalidEmbeddedPublicKeyError";constructor(t="Invalid embedded public key"){super(t),this.name="InvalidEmbeddedPublicKeyError"}};var Yt;(function(e){let t;(function(o){o.EOL="EOL"})(t=e.ValidityType||(e.ValidityType={}));let r;(function(o){o[o.EOL=0]="EOL"})(r||(r={})),function(o){o.codec=()=>Dr(r)}(t=e.ValidityType||(e.ValidityType={}));let n;e.codec=()=>(n==null&&(n=fr((o,i,s={})=>{s.lengthDelimited!==!1&&i.fork(),o.value!=null&&(i.uint32(10),i.bytes(o.value)),o.signatureV1!=null&&(i.uint32(18),i.bytes(o.signatureV1)),o.validityType!=null&&(i.uint32(24),e.ValidityType.codec().encode(o.validityType,i)),o.validity!=null&&(i.uint32(34),i.bytes(o.validity)),o.sequence!=null&&(i.uint32(40),i.uint64(o.sequence)),o.ttl!=null&&(i.uint32(48),i.uint64(o.ttl)),o.pubKey!=null&&(i.uint32(58),i.bytes(o.pubKey)),o.signatureV2!=null&&(i.uint32(66),i.bytes(o.signatureV2)),o.data!=null&&(i.uint32(74),i.bytes(o.data)),s.lengthDelimited!==!1&&i.ldelim()},(o,i,s={})=>{let a={},c=i==null?o.len:o.pos+i;for(;o.pos<c;){let l=o.uint32();switch(l>>>3){case 1:{a.value=o.bytes();break}case 2:{a.signatureV1=o.bytes();break}case 3:{a.validityType=e.ValidityType.codec().decode(o);break}case 4:{a.validity=o.bytes();break}case 5:{a.sequence=o.uint64();break}case 6:{a.ttl=o.uint64();break}case 7:{a.pubKey=o.bytes();break}case 8:{a.signatureV2=o.bytes();break}case 9:{a.data=o.bytes();break}default:{o.skipType(l&7);break}}}return a})),n),e.encode=o=>cr(o,e.codec()),e.decode=(o,i)=>ar(o,e.codec(),i)})(Yt||(Yt={}));var Zh=["string","number","bigint","symbol"],Wh=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Nc(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;if(Zh.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(Yh(e))return"Buffer";let r=Xh(e);return r||"Object"}function Yh(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Xh(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(Wh.includes(t))return t}var g=class{constructor(t,r,n){this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}};g.uint=new g(0,"uint",!0);g.negint=new g(1,"negint",!0);g.bytes=new g(2,"bytes",!0);g.string=new g(3,"string",!0);g.array=new g(4,"array",!1);g.map=new g(5,"map",!1);g.tag=new g(6,"tag",!1);g.float=new g(7,"float",!0);g.false=new g(7,"false",!0);g.true=new g(7,"true",!0);g.null=new g(7,"null",!0);g.undefined=new g(7,"undefined",!0);g.break=new g(7,"break",!0);var L=class{constructor(t,r,n){this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var yr=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Jh=new TextDecoder,Qh=new TextEncoder;function jn(e){return yr&&globalThis.Buffer.isBuffer(e)}function Lc(e){return e instanceof Uint8Array?jn(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var kc=yr?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):Rc(e,t,r):(e,t,r)=>r-t>64?Jh.decode(e.subarray(t,r)):Rc(e,t,r),Dc=yr?e=>e.length>64?globalThis.Buffer.from(e):Pc(e):e=>e.length>64?Qh.encode(e):Pc(e);var xr=yr?(e,t,r)=>jn(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),Fc=yr?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Lc(globalThis.Buffer.concat(e,t))):(e,t)=>{let r=new Uint8Array(t),n=0;for(let o of e)n+o.length>r.length&&(o=o.subarray(0,r.length-n)),r.set(o,n),n+=o.length;return r},Oc=yr?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Mc(e,t){if(jn(e)&&jn(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function Pc(e){let t=[],r=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128)}return t}function Rc(e,t,r){let n=[];for(;t<r;){let o=e[t],i=null,s=o>239?4:o>223?3:o>191?2:1;if(t+s<=r){let a,c,l,u;switch(s){case 1:o<128&&(i=o);break;case 2:a=e[t+1],(a&192)===128&&(u=(o&31)<<6|a&63,u>127&&(i=u));break;case 3:a=e[t+1],c=e[t+2],(a&192)===128&&(c&192)===128&&(u=(o&15)<<12|(a&63)<<6|c&63,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:a=e[t+1],c=e[t+2],l=e[t+3],(a&192)===128&&(c&192)===128&&(l&192)===128&&(u=(o&15)<<18|(a&63)<<12|(c&63)<<6|l&63,u>65535&&u<1114112&&(i=u))}}i===null?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|i&1023),n.push(i),t+=s}return tp(n)}var _c=4096;function tp(e){let t=e.length;if(t<=_c)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=_c));return r}var ep=256,Zn=class{constructor(t=ep){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let r=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){let o=r.length-(this.maxCursor-this.cursor)-1;r.set(t,o)}else{if(r){let o=r.length-(this.maxCursor-this.cursor)-1;o<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(r=Oc(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];t&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=xr(n,0,this.cursor)}else r=Fc(this.chunks,this.cursor);return t&&this.reset(),r}};var V="CBOR decode error:",os="CBOR encode error:",Hr=[];Hr[23]=1;Hr[24]=2;Hr[25]=3;Hr[26]=5;Hr[27]=9;function ge(e,t,r){if(e.length-t<r)throw new Error(`${V} not enough data for type`)}var ht=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Lt(e,t,r){ge(e,t,1);let n=e[t];if(r.strict===!0&&n<ht[0])throw new Error(`${V} integer encoded in more bytes than necessary (strict decode)`);return n}function kt(e,t,r){ge(e,t,2);let n=e[t]<<8|e[t+1];if(r.strict===!0&&n<ht[1])throw new Error(`${V} integer encoded in more bytes than necessary (strict decode)`);return n}function Dt(e,t,r){ge(e,t,4);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<ht[2])throw new Error(`${V} integer encoded in more bytes than necessary (strict decode)`);return n}function Ft(e,t,r){ge(e,t,8);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(r.strict===!0&&i<ht[3])throw new Error(`${V} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(r.allowBigInt===!0)return i;throw new Error(`${V} integers outside of the safe integer range are not supported`)}function Vc(e,t,r,n){return new L(g.uint,Lt(e,t+1,n),2)}function Kc(e,t,r,n){return new L(g.uint,kt(e,t+1,n),3)}function qc(e,t,r,n){return new L(g.uint,Dt(e,t+1,n),5)}function $c(e,t,r,n){return new L(g.uint,Ft(e,t+1,n),9)}function Mt(e,t){return gt(e,0,t.value)}function gt(e,t,r){if(r<ht[0]){let n=Number(r);e.push([t|n])}else if(r<ht[1]){let n=Number(r);e.push([t|24,n])}else if(r<ht[2]){let n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<ht[3]){let n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<ht[4]){let o=[t|27,0,0,0,0,0,0,0],i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=s&255,s=s>>8,o[3]=s&255,s=s>>8,o[2]=s&255,s=s>>8,o[1]=s&255,e.push(o)}else throw new Error(`${V} encountered BigInt larger than allowable range`)}}Mt.encodedSize=function(t){return gt.encodedSize(t.value)};gt.encodedSize=function(t){return t<ht[0]?1:t<ht[1]?2:t<ht[2]?3:t<ht[3]?5:9};Mt.compareTokens=function(t,r){return t.value<r.value?-1:t.value>r.value?1:0};function zc(e,t,r,n){return new L(g.negint,-1-Lt(e,t+1,n),2)}function Hc(e,t,r,n){return new L(g.negint,-1-kt(e,t+1,n),3)}function Gc(e,t,r,n){return new L(g.negint,-1-Dt(e,t+1,n),5)}var is=BigInt(-1),jc=BigInt(1);function Zc(e,t,r,n){let o=Ft(e,t+1,n);if(typeof o!="bigint"){let i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new L(g.negint,i,9)}if(n.allowBigInt!==!0)throw new Error(`${V} integers outside of the safe integer range are not supported`);return new L(g.negint,is-BigInt(o),9)}function Wn(e,t){let r=t.value,n=typeof r=="bigint"?r*is-jc:r*-1-1;gt(e,t.type.majorEncoded,n)}Wn.encodedSize=function(t){let r=t.value,n=typeof r=="bigint"?r*is-jc:r*-1-1;return n<ht[0]?1:n<ht[1]?2:n<ht[2]?3:n<ht[3]?5:9};Wn.compareTokens=function(t,r){return t.value<r.value?1:t.value>r.value?-1:0};function Gr(e,t,r,n){ge(e,t,r+n);let o=xr(e,t+r,t+r+n);return new L(g.bytes,o,r+n)}function Wc(e,t,r,n){return Gr(e,t,1,r)}function Yc(e,t,r,n){return Gr(e,t,2,Lt(e,t+1,n))}function Xc(e,t,r,n){return Gr(e,t,3,kt(e,t+1,n))}function Jc(e,t,r,n){return Gr(e,t,5,Dt(e,t+1,n))}function Qc(e,t,r,n){let o=Ft(e,t+1,n);if(typeof o=="bigint")throw new Error(`${V} 64-bit integer bytes lengths not supported`);return Gr(e,t,9,o)}function Yn(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===g.string?Dc(e.value):e.value),e.encodedBytes}function wr(e,t){let r=Yn(t);gt(e,t.type.majorEncoded,r.length),e.push(r)}wr.encodedSize=function(t){let r=Yn(t);return gt.encodedSize(r.length)+r.length};wr.compareTokens=function(t,r){return np(Yn(t),Yn(r))};function np(e,t){return e.length<t.length?-1:e.length>t.length?1:Mc(e,t)}function jr(e,t,r,n,o){let i=r+n;ge(e,t,i);let s=new L(g.string,kc(e,t+r,t+i),i);return o.retainStringBytes===!0&&(s.byteValue=xr(e,t+r,t+i)),s}function tu(e,t,r,n){return jr(e,t,1,r,n)}function eu(e,t,r,n){return jr(e,t,2,Lt(e,t+1,n),n)}function ru(e,t,r,n){return jr(e,t,3,kt(e,t+1,n),n)}function nu(e,t,r,n){return jr(e,t,5,Dt(e,t+1,n),n)}function ou(e,t,r,n){let o=Ft(e,t+1,n);if(typeof o=="bigint")throw new Error(`${V} 64-bit integer string lengths not supported`);return jr(e,t,9,o,n)}var iu=wr;function br(e,t,r,n){return new L(g.array,n,r)}function su(e,t,r,n){return br(e,t,1,r)}function au(e,t,r,n){return br(e,t,2,Lt(e,t+1,n))}function cu(e,t,r,n){return br(e,t,3,kt(e,t+1,n))}function uu(e,t,r,n){return br(e,t,5,Dt(e,t+1,n))}function fu(e,t,r,n){let o=Ft(e,t+1,n);if(typeof o=="bigint")throw new Error(`${V} 64-bit integer array lengths not supported`);return br(e,t,9,o)}function lu(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${V} indefinite length items not allowed`);return br(e,t,1,1/0)}function Xn(e,t){gt(e,g.array.majorEncoded,t.value)}Xn.compareTokens=Mt.compareTokens;Xn.encodedSize=function(t){return gt.encodedSize(t.value)};function Er(e,t,r,n){return new L(g.map,n,r)}function du(e,t,r,n){return Er(e,t,1,r)}function hu(e,t,r,n){return Er(e,t,2,Lt(e,t+1,n))}function pu(e,t,r,n){return Er(e,t,3,kt(e,t+1,n))}function mu(e,t,r,n){return Er(e,t,5,Dt(e,t+1,n))}function gu(e,t,r,n){let o=Ft(e,t+1,n);if(typeof o=="bigint")throw new Error(`${V} 64-bit integer map lengths not supported`);return Er(e,t,9,o)}function yu(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${V} indefinite length items not allowed`);return Er(e,t,1,1/0)}function Jn(e,t){gt(e,g.map.majorEncoded,t.value)}Jn.compareTokens=Mt.compareTokens;Jn.encodedSize=function(t){return gt.encodedSize(t.value)};function xu(e,t,r,n){return new L(g.tag,r,1)}function wu(e,t,r,n){return new L(g.tag,Lt(e,t+1,n),2)}function bu(e,t,r,n){return new L(g.tag,kt(e,t+1,n),3)}function Eu(e,t,r,n){return new L(g.tag,Dt(e,t+1,n),5)}function Su(e,t,r,n){return new L(g.tag,Ft(e,t+1,n),9)}function Qn(e,t){gt(e,g.tag.majorEncoded,t.value)}Qn.compareTokens=Mt.compareTokens;Qn.encodedSize=function(t){return gt.encodedSize(t.value)};var up=20,fp=21,lp=22,dp=23;function vu(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${V} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new L(g.null,null,1):new L(g.undefined,void 0,1)}function Au(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${V} indefinite length items not allowed`);return new L(g.break,void 0,1)}function ss(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${V} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${V} Infinity values are not supported`)}return new L(g.float,e,t)}function Iu(e,t,r,n){return ss(as(e,t+1),3,n)}function Tu(e,t,r,n){return ss(cs(e,t+1),5,n)}function Bu(e,t,r,n){return ss(Pu(e,t+1),9,n)}function to(e,t,r){let n=t.value;if(n===!1)e.push([g.float.majorEncoded|up]);else if(n===!0)e.push([g.float.majorEncoded|fp]);else if(n===null)e.push([g.float.majorEncoded|lp]);else if(n===void 0)e.push([g.float.majorEncoded|dp]);else{let o,i=!1;(!r||r.float64!==!0)&&(Uu(n),o=as(Xt,1),n===o||Number.isNaN(n)?(Xt[0]=249,e.push(Xt.slice(0,3)),i=!0):(Nu(n),o=cs(Xt,1),n===o&&(Xt[0]=250,e.push(Xt.slice(0,5)),i=!0))),i||(hp(n),o=Pu(Xt,1),Xt[0]=251,e.push(Xt.slice(0,9)))}}to.encodedSize=function(t,r){let n=t.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){Uu(n);let o=as(Xt,1);if(n===o||Number.isNaN(n))return 3;if(Nu(n),o=cs(Xt,1),n===o)return 5}return 9};var Cu=new ArrayBuffer(9),Vt=new DataView(Cu,1),Xt=new Uint8Array(Cu,0);function Uu(e){if(e===1/0)Vt.setUint16(0,31744,!1);else if(e===-1/0)Vt.setUint16(0,64512,!1);else if(Number.isNaN(e))Vt.setUint16(0,32256,!1);else{Vt.setFloat32(0,e);let t=Vt.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)Vt.setUint16(0,31744,!1);else if(r===0)Vt.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let o=r-127;o<-24?Vt.setUint16(0,0):o<-14?Vt.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):Vt.setUint16(0,(t&2147483648)>>16|o+15<<10|n>>13,!1)}}}function as(e,t){if(e.length-t<2)throw new Error(`${V} not enough data for float16`);let r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,o=r&1023,i;return n===0?i=o*2**-24:n!==31?i=(o+1024)*2**(n-25):i=o===0?1/0:NaN,r&32768?-i:i}function Nu(e){Vt.setFloat32(0,e,!1)}function cs(e,t){if(e.length-t<4)throw new Error(`${V} not enough data for float32`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function hp(e){Vt.setFloat64(0,e,!1)}function Pu(e,t){if(e.length-t<8)throw new Error(`${V} not enough data for float64`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}to.compareTokens=Mt.compareTokens;function Z(e,t,r){throw new Error(`${V} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function eo(e){return()=>{throw new Error(`${V} ${e}`)}}var B=[];for(let e=0;e<=23;e++)B[e]=Z;B[24]=Vc;B[25]=Kc;B[26]=qc;B[27]=$c;B[28]=Z;B[29]=Z;B[30]=Z;B[31]=Z;for(let e=32;e<=55;e++)B[e]=Z;B[56]=zc;B[57]=Hc;B[58]=Gc;B[59]=Zc;B[60]=Z;B[61]=Z;B[62]=Z;B[63]=Z;for(let e=64;e<=87;e++)B[e]=Wc;B[88]=Yc;B[89]=Xc;B[90]=Jc;B[91]=Qc;B[92]=Z;B[93]=Z;B[94]=Z;B[95]=eo("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)B[e]=tu;B[120]=eu;B[121]=ru;B[122]=nu;B[123]=ou;B[124]=Z;B[125]=Z;B[126]=Z;B[127]=eo("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)B[e]=su;B[152]=au;B[153]=cu;B[154]=uu;B[155]=fu;B[156]=Z;B[157]=Z;B[158]=Z;B[159]=lu;for(let e=160;e<=183;e++)B[e]=du;B[184]=hu;B[185]=pu;B[186]=mu;B[187]=gu;B[188]=Z;B[189]=Z;B[190]=Z;B[191]=yu;for(let e=192;e<=215;e++)B[e]=xu;B[216]=wu;B[217]=bu;B[218]=Eu;B[219]=Su;B[220]=Z;B[221]=Z;B[222]=Z;B[223]=Z;for(let e=224;e<=243;e++)B[e]=eo("simple values are not supported");B[244]=Z;B[245]=Z;B[246]=Z;B[247]=vu;B[248]=eo("simple values are not supported");B[249]=Iu;B[250]=Tu;B[251]=Bu;B[252]=Z;B[253]=Z;B[254]=Z;B[255]=Au;var Jt=[];for(let e=0;e<24;e++)Jt[e]=new L(g.uint,e,1);for(let e=-1;e>=-24;e--)Jt[31-e]=new L(g.negint,e,1);Jt[64]=new L(g.bytes,new Uint8Array(0),1);Jt[96]=new L(g.string,"",1);Jt[128]=new L(g.array,0,1);Jt[160]=new L(g.map,0,1);Jt[244]=new L(g.false,!1,1);Jt[245]=new L(g.true,!0,1);Jt[246]=new L(g.null,null,1);function mp(){let e=[];return e[g.uint.major]=Mt,e[g.negint.major]=Wn,e[g.bytes.major]=wr,e[g.string.major]=iu,e[g.array.major]=Xn,e[g.map.major]=Jn,e[g.tag.major]=Qn,e[g.float.major]=to,e}var u1=mp(),f1=new Zn,ro=class e{constructor(t,r){this.obj=t,this.parent=r}includes(t){let r=this;do if(r.obj===t)return!0;while(r=r.parent);return!1}static createCheck(t,r){if(t&&t.includes(r))throw new Error(`${os} object contains circular references`);return new e(r,t)}},Pe={null:new L(g.null,null),undefined:new L(g.undefined,void 0),true:new L(g.true,!0),false:new L(g.false,!1),emptyArray:new L(g.array,0),emptyMap:new L(g.map,0)},Re={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new L(g.float,e):e>=0?new L(g.uint,e):new L(g.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new L(g.uint,e):new L(g.negint,e)},Uint8Array(e,t,r,n){return new L(g.bytes,e)},string(e,t,r,n){return new L(g.string,e)},boolean(e,t,r,n){return e?Pe.true:Pe.false},null(e,t,r,n){return Pe.null},undefined(e,t,r,n){return Pe.undefined},ArrayBuffer(e,t,r,n){return new L(g.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new L(g.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[Pe.emptyArray,new L(g.break)]:Pe.emptyArray;n=ro.createCheck(n,e);let o=[],i=0;for(let s of e)o[i++]=us(s,r,n);return r.addBreakTokens?[new L(g.array,e.length),o,new L(g.break)]:[new L(g.array,e.length),o]},Object(e,t,r,n){let o=t!=="Object",i=o?e.keys():Object.keys(e),s=o?e.size:i.length;if(!s)return r.addBreakTokens===!0?[Pe.emptyMap,new L(g.break)]:Pe.emptyMap;n=ro.createCheck(n,e);let a=[],c=0;for(let l of i)a[c++]=[us(l,r,n),us(o?e.get(l):e[l],r,n)];return gp(a,r),r.addBreakTokens?[new L(g.map,s),a,new L(g.break)]:[new L(g.map,s),a]}};Re.Map=Re.Object;Re.Buffer=Re.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Re[`${e}Array`]=Re.DataView;function us(e,t={},r){let n=Nc(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||Re[n];if(typeof o=="function"){let s=o(e,n,t,r);if(s!=null)return s}let i=Re[n];if(!i)throw new Error(`${os} unsupported type: ${n}`);return i(e,n,t,r)}function gp(e,t){t.mapSorter&&e.sort(t.mapSorter)}var yp={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},no=class{constructor(t,r={}){this._pos=0,this.data=t,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){let t=this.data[this._pos],r=Jt[t];if(r===void 0){let n=B[t];if(!n)throw new Error(`${V} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);let o=t&31;r=n(this.data,this._pos,o,this.options)}return this._pos+=r.encodedLength,r}},Zr=Symbol.for("DONE"),oo=Symbol.for("BREAK");function xp(e,t,r){let n=[];for(let o=0;o<e.value;o++){let i=Sr(t,r);if(i===oo){if(e.value===1/0)break;throw new Error(`${V} got unexpected break to lengthed array`)}if(i===Zr)throw new Error(`${V} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=i}return n}function wp(e,t,r){let n=r.useMaps===!0,o=n?void 0:{},i=n?new Map:void 0;for(let s=0;s<e.value;s++){let a=Sr(t,r);if(a===oo){if(e.value===1/0)break;throw new Error(`${V} got unexpected break to lengthed map`)}if(a===Zr)throw new Error(`${V} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${V} non-string keys not supported (got ${typeof a})`);if(r.rejectDuplicateMapKeys===!0&&(n&&i.has(a)||!n&&a in o))throw new Error(`${V} found repeat map key "${a}"`);let c=Sr(t,r);if(c===Zr)throw new Error(`${V} found map but not enough entries (got ${s} [no value], expected ${e.value})`);n?i.set(a,c):o[a]=c}return n?i:o}function Sr(e,t){if(e.done())return Zr;let r=e.next();if(r.type===g.break)return oo;if(r.type.terminal)return r.value;if(r.type===g.array)return xp(r,e,t);if(r.type===g.map)return wp(r,e,t);if(r.type===g.tag){if(t.tags&&typeof t.tags[r.value]=="function"){let n=Sr(e,t);return t.tags[r.value](n)}throw new Error(`${V} tag not supported (${r.value})`)}throw new Error("unsupported")}function Ru(e,t){if(!(e instanceof Uint8Array))throw new Error(`${V} data to decode must be a Uint8Array`);t=Object.assign({},yp,t);let r=t.tokenizer||new no(e,t),n=Sr(r,t);if(n===Zr)throw new Error(`${V} did not find any content to decode`);if(n===oo)throw new Error(`${V} got unexpected break`);return[n,e.subarray(r.pos())]}function fs(e,t){let[r,n]=Ru(e,t);if(n.length>0)throw new Error(`${V} too many terminals, data makes no sense`);return r}var Sp=we("ipns:utils"),_u=H("/ipns/");var vp=0,Ap=18;function Lu(e){let t;if(e.pubKey!=null)try{t=lc(e.pubKey)}catch(r){throw Sp.error(r),r}if(t!=null)return t}function ku(e){let t=H("ipns-signature:");return Et([t,e])}function Ge(e){return"signatureV1"in e?Yt.encode({value:H(e.value),signatureV1:e.signatureV1,validityType:e.validityType,validity:H(e.validity),sequence:e.sequence,ttl:e.ttl,pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data}):Yt.encode({pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data})}function oe(e){let t=Yt.decode(e);if(t.sequence!=null&&(t.sequence=BigInt(t.sequence)),t.ttl!=null&&(t.ttl=BigInt(t.ttl)),t.signatureV2==null||t.data==null)throw new Wt("Missing data or signatureV2");let r=Du(t.data),n=Ip(r.Value),o=G(r.Validity);if(t.value!=null&&t.signatureV1!=null)return Tp(t),{value:n,validityType:Yt.ValidityType.EOL,validity:o,sequence:r.Sequence,ttl:r.TTL,pubKey:t.pubKey,signatureV1:t.signatureV1,signatureV2:t.signatureV2,data:t.data};if(t.signatureV2!=null)return{value:n,validityType:Yt.ValidityType.EOL,validity:o,sequence:r.Sequence,ttl:r.TTL,pubKey:t.pubKey,signatureV2:t.signatureV2,data:t.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}function Wr(e){return Et([_u,e.bytes])}function ye(e){let t=ce(e.slice(_u.length));if(!io(t,vp)&&!io(t,Ap))throw new Ze("Multihash in IPNS key was not identity or sha2-256");return t}function Du(e){let t=fs(e);if(t.ValidityType===0)t.ValidityType=Yt.ValidityType.EOL;else throw new gr("The validity type is unsupported");return Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t}function Ip(e){let t=G(e).trim();if(t.startsWith("/"))return t;try{return`/ipfs/${W.decode(e).toV1().toString()}`}catch{}try{return`/ipfs/${W.parse(t).toV1().toString()}`}catch{}throw new Hn("Value must be a valid content path starting with /")}function Tp(e){if(e.data==null)throw new Gn("Record data is missing");let t=Du(e.data);if(!ot(t.Value,e.value??new Uint8Array(0)))throw new Wt('Field "value" did not match between protobuf and CBOR');if(!ot(t.Validity,e.validity??new Uint8Array(0)))throw new Wt('Field "validity" did not match between protobuf and CBOR');if(t.ValidityType!==e.validityType)throw new Wt('Field "validityType" did not match between protobuf and CBOR');if(t.Sequence!==e.sequence)throw new Wt('Field "sequence" did not match between protobuf and CBOR');if(t.TTL!==e.ttl)throw new Wt('Field "ttl" did not match between protobuf and CBOR')}function io(e,t){return e.code===t}var L1=we("ipns"),k1=60*60*1e9,Cp="/ipns/",D1=Cp.length;var Fu=wo(ns(),1);var so=we("ipns:validator"),Up=1024*10,Np=async(e,t)=>{let r=oe(t),n;try{let o=ku(r.data);n=await e.verify(o,r.signatureV2)}catch{n=!1}if(!n)throw so.error("record signature verification failed"),new Wt("Record signature verification failed");if(r.validityType===Yt.ValidityType.EOL){if(Fu.default.fromString(r.validity).toDate().getTime()<Date.now())throw so.error("record has expired"),new $n("record has expired")}else if(r.validityType!=null)throw so.error("the validity type is unsupported"),new gr("The validity type is unsupported");so("ipns record for %s is valid",r.value)};async function Ou(e,t){if(t.byteLength>Up)throw new zn("The record is too large");let r=ye(e),n;io(r,0)&&(n=Rn(r));let o=oe(t),i=Lu(o)??n;if(i==null)throw new zr("Could not extract public key from IPNS record or routing key");let s=Wr(i.toMultihash());if(!ot(s,e))throw new zr("Embedded public key did not match routing key");await Np(i,t)}var ao=class extends Error{name="InvalidMessageLengthError";code="ERR_INVALID_MESSAGE_LENGTH"};async function*Yr(e,t={}){let r=/\r?\n/,n=new TextDecoder("utf8"),o="";for await(let i of e){if(typeof i=="string"&&(i=new TextEncoder().encode(i)),dr(i)&&(i=i.subarray()),o+=n.decode(i,{stream:!0}),o.length>(t?.maxMessageLength??o.length))throw new ao("Incoming message too long");let s=o.split(r);o=s.pop()??"";for(let a=0;a<s.length;a++)yield JSON.parse(s[a])}o+=n.decode(),o!==""&&(yield JSON.parse(o))}function ie(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}var ds=wo(Vu(),1);var Jr=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},hs=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},Ku=e=>globalThis.DOMException===void 0?new hs(e):new DOMException(e),qu=e=>{let t=e.reason===void 0?Ku("This operation was aborted."):e.reason;return t instanceof Error?t:Ku(t)};function ps(e,t){let{milliseconds:r,fallback:n,message:o,customTimers:i={setTimeout,clearTimeout}}=t,s,a,l=new Promise((u,f)=>{if(typeof r!="number"||Math.sign(r)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(t.signal){let{signal:b}=t;b.aborted&&f(qu(b)),a=()=>{f(qu(b))},b.addEventListener("abort",a,{once:!0})}if(r===Number.POSITIVE_INFINITY){e.then(u,f);return}let d=new Jr;s=i.setTimeout.call(void 0,()=>{if(n){try{u(n())}catch(b){f(b)}return}typeof e.cancel=="function"&&e.cancel(),o===!1?u():o instanceof Error?f(o):(d.message=o??`Promise timed out after ${r} milliseconds`,f(d))},r),(async()=>{try{u(await e)}catch(b){f(b)}})()}).finally(()=>{l.clear(),a&&t.signal&&t.signal.removeEventListener("abort",a)});return l.clear=()=>{i.clearTimeout.call(void 0,s),s=void 0},l}function ms(e,t,r){let n=0,o=e.length;for(;o>0;){let i=Math.trunc(o/2),s=n+i;r(e[s],t)<=0?(n=++s,o-=i+1):o=i}return n}var Qr=class{#t=[];enqueue(t,r){r={priority:0,...r};let n={priority:r.priority,id:r.id,run:t};if(this.size===0||this.#t[this.size-1].priority>=r.priority){this.#t.push(n);return}let o=ms(this.#t,n,(i,s)=>s.priority-i.priority);this.#t.splice(o,0,n)}setPriority(t,r){let n=this.#t.findIndex(i=>i.id===t);if(n===-1)throw new ReferenceError(`No promise function with the id "${t}" exists in the queue.`);let[o]=this.#t.splice(n,1);this.enqueue(o.run,{priority:r,id:t})}dequeue(){return this.#t.shift()?.run}filter(t){return this.#t.filter(r=>r.priority===t.priority).map(r=>r.run)}get size(){return this.#t.length}};var tn=class extends ds.default{#t;#r;#e=0;#a;#c;#p=0;#o;#u;#n;#m;#i=0;#f;#s;#g;#w=1n;timeout;constructor(t){if(super(),t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Qr,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${t.intervalCap?.toString()??""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${t.interval?.toString()??""}\` (${typeof t.interval})`);this.#t=t.carryoverConcurrencyCount,this.#r=t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,this.#a=t.intervalCap,this.#c=t.interval,this.#n=new t.queueClass,this.#m=t.queueClass,this.concurrency=t.concurrency,this.timeout=t.timeout,this.#g=t.throwOnTimeout===!0,this.#s=t.autoStart===!1}get#b(){return this.#r||this.#e<this.#a}get#E(){return this.#i<this.#f}#S(){this.#i--,this.#l(),this.emit("next")}#v(){this.#x(),this.#y(),this.#u=void 0}get#A(){let t=Date.now();if(this.#o===void 0){let r=this.#p-t;if(r<0)this.#e=this.#t?this.#i:0;else return this.#u===void 0&&(this.#u=setTimeout(()=>{this.#v()},r)),!0}return!1}#l(){if(this.#n.size===0)return this.#o&&clearInterval(this.#o),this.#o=void 0,this.emit("empty"),this.#i===0&&this.emit("idle"),!1;if(!this.#s){let t=!this.#A;if(this.#b&&this.#E){let r=this.#n.dequeue();return r?(this.emit("active"),r(),t&&this.#y(),!0):!1}}return!1}#y(){this.#r||this.#o!==void 0||(this.#o=setInterval(()=>{this.#x()},this.#c),this.#p=Date.now()+this.#c)}#x(){this.#e===0&&this.#i===0&&this.#o&&(clearInterval(this.#o),this.#o=void 0),this.#e=this.#t?this.#i:0,this.#d()}#d(){for(;this.#l(););}get concurrency(){return this.#f}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this.#f=t,this.#d()}async#I(t){return new Promise((r,n)=>{t.addEventListener("abort",()=>{n(t.reason)},{once:!0})})}setPriority(t,r){this.#n.setPriority(t,r)}async add(t,r={}){return r.id??=(this.#w++).toString(),r={timeout:this.timeout,throwOnTimeout:this.#g,...r},new Promise((n,o)=>{this.#n.enqueue(async()=>{this.#i++,this.#e++;try{r.signal?.throwIfAborted();let i=t({signal:r.signal});r.timeout&&(i=ps(Promise.resolve(i),{milliseconds:r.timeout})),r.signal&&(i=Promise.race([i,this.#I(r.signal)]));let s=await i;n(s),this.emit("completed",s)}catch(i){if(i instanceof Jr&&!r.throwOnTimeout){n();return}o(i),this.emit("error",i)}finally{this.#S()}},r),this.emit("add"),this.#l()})}async addAll(t,r){return Promise.all(t.map(async n=>this.add(n,r)))}start(){return this.#s?(this.#s=!1,this.#d(),this):this}pause(){this.#s=!0}clear(){this.#n=new this.#m}async onEmpty(){this.#n.size!==0&&await this.#h("empty")}async onSizeLessThan(t){this.#n.size<t||await this.#h("next",()=>this.#n.size<t)}async onIdle(){this.#i===0&&this.#n.size===0||await this.#h("idle")}async#h(t,r){return new Promise(n=>{let o=()=>{r&&!r()||(this.off(t,o),n())};this.on(t,o)})}get size(){return this.#n.size}sizeBy(t){return this.#n.filter(t).length}get pending(){return this.#i}get isPaused(){return this.#s}};var vr=class extends Error{static name="InvalidRequestError";constructor(t="Invalid request"){super(t),this.name="InvalidRequestError"}},Qt=class extends Error{static name="BadResponseError";constructor(t="Bad response"){super(t),this.name="BadResponseError"}};function _p(e){return e[Symbol.asyncIterator]!=null}function Lp(e){if(_p(e))return(async()=>{for await(let t of e)return t})();for(let t of e)return t}var uo=Lp;function kp(e){let[t,r]=e[Symbol.asyncIterator]!=null?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:t.next(),[r](){return this}}}var $u=kp;function Dp(e){return e[Symbol.asyncIterator]!=null}function Fp(e,t){let r=0;if(Dp(e))return async function*(){for await(let c of e)yield t(c,r++)}();let n=$u(e),{value:o,done:i}=n.next();if(i===!0)return function*(){}();let s=t(o,r++);if(typeof s.then=="function")return async function*(){yield await s;for await(let c of n)yield t(c,r++)}();let a=t;return function*(){yield s;for(let c of n)yield a(c,r++)}()}var fo=Fp;var zu=H("/ipns/");function Hu(e){return ot(e.subarray(0,zu.byteLength),zu)}var lo=class{client;constructor(t){this.client=t}async*findProviders(t,r={}){yield*fo(this.client.getProviders(t,r),n=>({id:n.ID,multiaddrs:n.Addrs??[]}))}async provide(){}async cancelReprovide(){}async put(t,r,n){if(!Hu(t))return;let o=ye(t),i=W.createV1(114,o),s=oe(r);await this.client.putIPNS(i,s,n)}async get(t,r){if(!Hu(t))throw new Bt("Not found");let n=ye(t),o=W.createV1(114,n);try{let i=await this.client.getIPNS(o,r);return Ge(i)}catch(i){throw i.name==="BadResponseError"?new Bt("Not found"):i}}},ho=class{client;constructor(t){this.client=t}async findPeer(t,r={}){let n=await uo(this.client.getPeers(t,r));if(n!=null)return{id:n.ID,multiaddrs:n.Addrs??[]};throw new Bt("Not found")}async*getClosestPeers(t,r={}){}};var pt=we("delegated-routing-v1-http-api-client"),po={concurrentRequests:4,timeout:3e4,cacheTTL:5*60*1e3,cacheName:"delegated-routing-v1-cache"},mo=class{started;httpQueue;shutDownController;clientUrl;timeout;contentRouting;peerRouting;filterAddrs;filterProtocols;inFlightRequests;cacheName;cache;cacheTTL;constructor(t,r={}){this.started=!1,this.shutDownController=new AbortController,this.shutDownController.signal,this.httpQueue=new tn({concurrency:r.concurrentRequests??po.concurrentRequests}),this.inFlightRequests=new Map,this.clientUrl=t instanceof URL?t:new URL(t),this.timeout=r.timeout??po.timeout,this.filterAddrs=r.filterAddrs,this.filterProtocols=r.filterProtocols,this.contentRouting=new lo(this),this.peerRouting=new ho(this),this.cacheName=r.cacheName??po.cacheName,this.cacheTTL=r.cacheTTL??po.cacheTTL}get[ks](){return this.contentRouting}get[Ds](){return this.peerRouting}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cacheTTL>0&&(this.cache=await globalThis.caches?.open(this.cacheName),this.cache!=null&&pt("cache enabled with ttl %d",this.cacheTTL)))}async stop(){this.httpQueue.clear(),this.shutDownController.abort(),await globalThis.caches?.delete(this.cacheName),this.started=!1}async*getProviders(t,r={}){pt("getProviders starts: %c",t);let n=AbortSignal.timeout(this.timeout),o=$r([this.shutDownController.signal,n,r.signal]);let i=ie(),s=ie();this.httpQueue.add(async()=>(i.resolve(),s.promise));try{await i.promise;let a=new URL(`${this.clientUrl}routing/v1/providers/${t.toString()}`);this.#r(a,r.filterAddrs,r.filterProtocols);let c={headers:{Accept:"application/x-ndjson"},signal:o},l=await this.#e(a.toString(),c);if(l==null)throw new Qt("No response received");if(!l.ok)throw l.status===404?new Bt("No matching records found"):l.status===422?new vr("Request does not conform to schema or semantic constraints"):new Qt(`Unexpected status code: ${l.status}`);if(l.body==null)throw new Qt("Routing response had no body");let u=l.headers.get("Content-Type");if(u==null)throw new Qt("No Content-Type header received");if(u?.startsWith("application/json")){let f=await l.json();for(let d of f.Providers){let b=this.#t(d);b!=null&&(yield b)}}else if(u.includes("application/x-ndjson"))for await(let f of Yr(qn(l.body))){let d=this.#t(f);d!=null&&(yield d)}else throw new Qt(`Unsupported Content-Type: ${u}`)}catch(a){pt.error("getProviders errored:",a)}finally{o.clear(),s.resolve(),pt("getProviders finished: %c",t)}}async*getPeers(t,r={}){pt("getPeers starts: %c",t);let n=AbortSignal.timeout(this.timeout),o=$r([this.shutDownController.signal,n,r.signal]);let i=ie(),s=ie();this.httpQueue.add(async()=>(i.resolve(),s.promise));try{await i.promise;let a=new URL(`${this.clientUrl}routing/v1/peers/${t.toCID().toString()}`);this.#r(a,r.filterAddrs,r.filterProtocols);let c={headers:{Accept:"application/x-ndjson"},signal:o},l=await this.#e(a.toString(),c);if(l.status===404)throw new Bt("No matching records found");if(l.status===422)throw new vr("Request does not conform to schema or semantic constraints");if(l.body==null)throw new Qt("Routing response had no body");if(l.headers.get("Content-Type")==="application/json"){let f=await l.json();for(let d of f.Peers){let b=this.#t(d);b!=null&&(yield b)}}else for await(let f of Yr(qn(l.body))){let d=this.#t(f);d!=null&&(yield d)}}catch(a){pt.error("getPeers errored:",a)}finally{o.clear(),s.resolve(),pt("getPeers finished: %c",t)}}async getIPNS(t,r={}){pt("getIPNS starts: %s",t);let n=AbortSignal.timeout(this.timeout),o=$r([this.shutDownController.signal,n,r.signal]);let i=ie(),s=ie();this.httpQueue.add(async()=>(i.resolve(),s.promise));let a=`${this.clientUrl}routing/v1/ipns/${t}`;try{await i.promise;let c={headers:{Accept:"application/vnd.ipfs.ipns-record"},signal:o},l=await this.#e(a,c);if(pt("getIPNS GET %s %d",a,l.status),l.status===404)throw new Bt("No matching records found");if(l.status===422)throw new vr("Request does not conform to schema or semantic constraints");if(l.body==null)throw new Qt("GET ipns response had no body");let u=await l.arrayBuffer(),f=new Uint8Array(u,0,u.byteLength);return r.validate!==!1&&await Ou(Wr(t.multihash),f),oe(f)}catch(c){throw pt.error("getIPNS GET %s error:",a,c),c}finally{o.clear(),s.resolve(),pt("getIPNS finished: %s",t)}}async putIPNS(t,r,n={}){pt("putIPNS starts: %c",t);let o=AbortSignal.timeout(this.timeout),i=$r([this.shutDownController.signal,o,n.signal]);let s=ie(),a=ie();this.httpQueue.add(async()=>(s.resolve(),a.promise));let c=`${this.clientUrl}routing/v1/ipns/${t}`;try{await s.promise;let l=Ge(r),u={method:"PUT",headers:{"Content-Type":"application/vnd.ipfs.ipns-record"},body:l,signal:i},f=await this.#e(c,u);if(pt("putIPNS PUT %s %d",c,f.status),f.status!==200)throw new Qt("PUT ipns response had status other than 200")}catch(l){throw pt.error("putIPNS PUT %s error:",c,l.stack),l}finally{i.clear(),a.resolve(),pt("putIPNS finished: %c",t)}}#t(t){try{let r=[],n=t.Addrs?.map(ze)??[];return t.Protocols!=null&&r.push(...t.Protocols),t.Protocol!=null&&(r.push(t.Protocol),delete t.Protocol),{...t,Schema:"peer",ID:pc(t.ID),Addrs:n,Protocols:r}}catch(r){pt.error("could not conform record to peer schema",r)}}#r(t,r,n){if(r!=null||this.filterAddrs!=null){let o=r?.join(",")??this.filterAddrs?.join(",")??"";o!==""&&t.searchParams.set("filter-addrs",o)}if(n!=null||this.filterProtocols!=null){let o=n?.join(",")??this.filterProtocols?.join(",")??"";o!==""&&t.searchParams.set("filter-protocols",o)}}async#e(t,r){let n=r.method??"GET",o=`${n}-${t}`;if(n==="GET"){let c=await this.cache?.match(t);if(c!=null){if(parseInt(c.headers.get("x-cache-expires")??"0",10)>Date.now())return pt("returning cached response for %s",o),c;await this.cache?.delete(t)}}let i=this.inFlightRequests.get(o);if(i!=null){let c=await i;return pt("deduplicating outgoing request for %s",o),c.clone()}let s=fetch(t,r).then(async c=>{if(this.cache!=null&&c.ok&&n==="GET"){let l=Date.now()+this.cacheTTL,u=new Headers(c.headers);u.set("x-cache-expires",l.toString());let f=new Response(c.clone().body,{status:c.status,statusText:c.statusText,headers:u});await this.cache.put(t,f)}return c}).finally(()=>{this.inFlightRequests.delete(o)});return this.inFlightRequests.set(o,s),await s}};function Gu(e,t={}){return new mo(new URL(e),t)}function go(){return{filterProtocols:["unknown","transport-bitswap","transport-ipfs-gateway-http"],filterAddrs:["https","webtransport","webrtc","webrtc-direct","wss","tls"]}}var ju=H("/ipns/");function Zu(e){return ot(e.subarray(0,ju.byteLength),ju)}var gs=class{client;constructor(t,r={}){this.client=Gu(t,r)}async provide(t,r){}async cancelReprovide(t,r){}async*findProviders(t,r){yield*fo(this.client.getProviders(t,r),n=>({id:n.ID,multiaddrs:n.Addrs,protocols:n.Protocols}))}async put(t,r,n){if(!Zu(t))return;let o=ye(t),i=W.createV1(114,o),s=oe(r);await this.client.putIPNS(i,s,n)}async get(t,r){if(!Zu(t))throw new Bt("Not found");let n=ye(t),o=W.createV1(114,n);try{let i=await this.client.getIPNS(o,r);return Ge(i)}catch(i){throw i.name==="BadResponseError"?new Bt("Not found"):i}}async findPeer(t,r){let n=await uo(this.client.getPeers(t,r));if(n!=null)return{id:n.ID,multiaddrs:n.Addrs??[]};throw new Bt("Not found")}async*getClosestPeers(t,r){}};function Wu(e,t){let r=t??go();return new gs(new URL(e),r)}var Yu="[a-fA-F\\d:]",_e=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${Yu})|(?<=${Yu})(?=\\s|$))`:"",te="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",at="[a-fA-F\\d]{1,4}",yo=`
(?:
(?:${at}:){7}(?:${at}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${at}:){6}(?:${te}|:${at}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${at}:){5}(?::${te}|(?::${at}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${at}:){4}(?:(?::${at}){0,1}:${te}|(?::${at}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${at}:){3}(?:(?::${at}){0,2}:${te}|(?::${at}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${at}:){2}(?:(?::${at}){0,3}:${te}|(?::${at}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${at}:){1}(?:(?::${at}){0,4}:${te}|(?::${at}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${at}){0,5}:${te}|(?::${at}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Op=new RegExp(`(?:^${te}$)|(?:^${yo}$)`),Mp=new RegExp(`^${te}$`),Vp=new RegExp(`^${yo}$`),ys=e=>e&&e.exact?Op:new RegExp(`(?:${_e(e)}${te}${_e(e)})|(?:${_e(e)}${yo}${_e(e)})`,"g");ys.v4=e=>e&&e.exact?Mp:new RegExp(`${_e(e)}${te}${_e(e)}`,"g");ys.v6=e=>e&&e.exact?Vp:new RegExp(`${_e(e)}${yo}${_e(e)}`,"g");var xs=ys;function ws(e){let t=(...r)=>e(...r);return Object.defineProperty(t,"name",{value:`functionTimeout(${e.name||"<anonymous>"})`,configurable:!0}),t}function Xu(){return!1}var{toString:Kp}=Object.prototype;function bs(e){return Kp.call(e)==="[object RegExp]"}var Ju={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function Es(e,t={}){if(!bs(e))throw new TypeError("Expected a RegExp instance");let r=Object.keys(Ju).map(o=>(typeof t[o]=="boolean"?t[o]:e[o])?Ju[o]:"").join(""),n=new RegExp(t.source||e.source,r);return n.lastIndex=typeof t.lastIndex=="number"?t.lastIndex:e.lastIndex,n}function Ss(e,t,{timeout:r}={}){try{return ws(()=>Es(e).test(t),{timeout:r})()}catch(n){if(Xu(n))return!1;throw n}}var qp=15,$p=45,Qu={timeout:400};function vs(e){return e.length>$p?!1:Ss(xs.v6({exact:!0}),e,Qu)}function tf(e){return e.length>qp?!1:Ss(xs.v4({exact:!0}),e,Qu)}var ef={http:"80",https:"443",ws:"80",wss:"443"},zp=["http","https","ws","wss"];function rf(e,t){t=t??{};let r=t.defaultDnsType??"dns4",{scheme:n,hostname:o,port:i}=Hp(e),a="/"+[Gp(o,r),jp(i,n),Zp(n)].filter(c=>!!c).reduce((c,l)=>c.concat(l),[]).join("/");return ze(a)}function Hp(e){let[t]=e.split(":");zp.includes(t)||(e="http"+e.substring(t.length));let{protocol:r,hostname:n,port:o}=new URL(e);if(o==null||o===""){let i=Wp(t);i!=null&&(o=i),i==null&&r==="http:"&&(o="80")}return{scheme:t,hostname:n,port:o}}function Gp(e,t){if(!(e==null||e==="")){if(tf(e))return["ip4",e];if(vs(e))return["ip6",e];if(e[0]==="["){let r=e.substring(1,e.length-1);if(vs(r))return["ip6",r]}return[t,e]}}function jp(e,t){if(!(e==null||e===""))return t==="udp"?["udp",e]:["tcp",e]}function Zp(e){if(e.match(/^tcp$|^udp$/)==null)return[e]}function Wp(e){if(!(e==null||e===""||ef[e]==null))return ef[e]}var Yp=["https://trustless-gateway.link","https://4everland.io"],Xp=2336;function Jp(e){return e=e.toString(),{id:Ki(W.createV1(Xp,$t.digest(H(e)))),multiaddrs:[rf(e)]}}var As=class{gateways;constructor(t={}){this.gateways=(t.gateways??Yp).map(r=>Jp(r))}async*findProviders(t,r){yield*this.gateways.toSorted(()=>Math.random()>.5?1:-1).map(n=>({...n,protocols:["transport-ipfs-gateway-http"]}))}};function nf(e={}){return new As(e)}var Is=class{libp2p;constructor(t){this.libp2p=t}async provide(t,r){await this.libp2p.contentRouting.provide(t,r)}async cancelReprovide(t,r){await this.libp2p.contentRouting.cancelReprovide(t,r)}async*findProviders(t,r){yield*this.libp2p.contentRouting.findProviders(t,r)}async put(t,r,n){await this.libp2p.contentRouting.put(t,r,n)}async get(t,r){return this.libp2p.contentRouting.get(t,r)}async findPeer(t,r){return this.libp2p.peerRouting.findPeer(t,r)}async*getClosestPeers(t,r){yield*this.libp2p.peerRouting.getClosestPeers(t,r)}};function of(e){return new Is(e)}return wf(Qp);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return HeliaRouters}));
